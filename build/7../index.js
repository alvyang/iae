webpackJsonp([7],{

/***/ 81:
/***/ (function(module, exports, __webpack_require__) {

var __vue_exports__, __vue_options__
var __vue_styles__ = {}

/* styles */
__webpack_require__(832)

/* script */
__vue_exports__ = __webpack_require__(834)

/* template */
var __vue_template__ = __webpack_require__(835)
__vue_options__ = __vue_exports__ = __vue_exports__ || {}
if (
  typeof __vue_exports__.default === "object" ||
  typeof __vue_exports__.default === "function"
) {
if (Object.keys(__vue_exports__).some(function (key) { return key !== "default" && key !== "__esModule" })) {console.error("named exports are not supported in *.vue files.")}
__vue_options__ = __vue_exports__ = __vue_exports__.default
}
if (typeof __vue_options__ === "function") {
  __vue_options__ = __vue_options__.options
}
__vue_options__.__file = "/Users/lvyang/workspace/iae/views/refunds/refundsale.vue"
__vue_options__.render = __vue_template__.render
__vue_options__.staticRenderFns = __vue_template__.staticRenderFns

/* hot reload */
if (false) {(function () {
  var hotAPI = require("vue-hot-reload-api")
  hotAPI.install(require("vue"), false)
  if (!hotAPI.compatible) return
  module.hot.accept()
  if (!module.hot.data) {
    hotAPI.createRecord("data-v-d0c9fea8", __vue_options__)
  } else {
    hotAPI.reload("data-v-d0c9fea8", __vue_options__)
  }
})()}
if (__vue_options__.functional) {console.error("[vue-loader] refundsale.vue: functional components are not supported and should be defined in plain js files using render functions.")}

module.exports = __vue_exports__


/***/ }),

/***/ 82:
/***/ (function(module, exports, __webpack_require__) {

var __vue_exports__, __vue_options__
var __vue_styles__ = {}

/* styles */
__webpack_require__(836)

/* script */
__vue_exports__ = __webpack_require__(838)

/* template */
var __vue_template__ = __webpack_require__(839)
__vue_options__ = __vue_exports__ = __vue_exports__ || {}
if (
  typeof __vue_exports__.default === "object" ||
  typeof __vue_exports__.default === "function"
) {
if (Object.keys(__vue_exports__).some(function (key) { return key !== "default" && key !== "__esModule" })) {console.error("named exports are not supported in *.vue files.")}
__vue_options__ = __vue_exports__ = __vue_exports__.default
}
if (typeof __vue_options__ === "function") {
  __vue_options__ = __vue_options__.options
}
__vue_options__.__file = "/Users/lvyang/workspace/iae/views/refunds/refundpurchase.vue"
__vue_options__.render = __vue_template__.render
__vue_options__.staticRenderFns = __vue_template__.staticRenderFns

/* hot reload */
if (false) {(function () {
  var hotAPI = require("vue-hot-reload-api")
  hotAPI.install(require("vue"), false)
  if (!hotAPI.compatible) return
  module.hot.accept()
  if (!module.hot.data) {
    hotAPI.createRecord("data-v-b34c2c34", __vue_options__)
  } else {
    hotAPI.reload("data-v-b34c2c34", __vue_options__)
  }
})()}
if (__vue_options__.functional) {console.error("[vue-loader] refundpurchase.vue: functional components are not supported and should be defined in plain js files using render functions.")}

module.exports = __vue_exports__


/***/ }),

/***/ 83:
/***/ (function(module, exports, __webpack_require__) {

var __vue_exports__, __vue_options__
var __vue_styles__ = {}

/* styles */
__webpack_require__(840)

/* script */
__vue_exports__ = __webpack_require__(842)

/* template */
var __vue_template__ = __webpack_require__(843)
__vue_options__ = __vue_exports__ = __vue_exports__ || {}
if (
  typeof __vue_exports__.default === "object" ||
  typeof __vue_exports__.default === "function"
) {
if (Object.keys(__vue_exports__).some(function (key) { return key !== "default" && key !== "__esModule" })) {console.error("named exports are not supported in *.vue files.")}
__vue_options__ = __vue_exports__ = __vue_exports__.default
}
if (typeof __vue_options__ === "function") {
  __vue_options__ = __vue_options__.options
}
__vue_options__.__file = "/Users/lvyang/workspace/iae/views/allot/allotReturnMoney.vue"
__vue_options__.render = __vue_template__.render
__vue_options__.staticRenderFns = __vue_template__.staticRenderFns

/* hot reload */
if (false) {(function () {
  var hotAPI = require("vue-hot-reload-api")
  hotAPI.install(require("vue"), false)
  if (!hotAPI.compatible) return
  module.hot.accept()
  if (!module.hot.data) {
    hotAPI.createRecord("data-v-6b355fcc", __vue_options__)
  } else {
    hotAPI.reload("data-v-6b355fcc", __vue_options__)
  }
})()}
if (__vue_options__.functional) {console.error("[vue-loader] allotReturnMoney.vue: functional components are not supported and should be defined in plain js files using render functions.")}

module.exports = __vue_exports__


/***/ }),

/***/ 832:
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__(833);
if(typeof content === 'string') content = [[module.i, content, '']];
// add the styles to the DOM
var update = __webpack_require__(91)(content, {});
if(content.locals) module.exports = content.locals;
// Hot Module Replacement
if(false) {
	// When the styles change, update the <style> tags
	if(!content.locals) {
		module.hot.accept("!!../../node_modules/css-loader/index.js!../../node_modules/vue-loader/lib/style-rewriter.js?id=data-v-d0c9fea8!../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./refundsale.vue", function() {
			var newContent = require("!!../../node_modules/css-loader/index.js!../../node_modules/vue-loader/lib/style-rewriter.js?id=data-v-d0c9fea8!../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./refundsale.vue");
			if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];
			update(newContent);
		});
	}
	// When the module is disposed, remove the <style> tags
	module.hot.dispose(function() { update(); });
}

/***/ }),

/***/ 833:
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__(2)();
// imports


// module
exports.push([module.i, "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", ""]);

// exports


/***/ }),

/***/ 834:
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//

exports.default = {
  data: function data() {
    var _this = this;

    var validateNum = function validateNum(rule, value, callback) {
      var regu = /^\+?[1-9][0-9]*$/;
      if (value === '') {
        callback(new Error('请输入计划数量'));
      } else if (!regu.test(value)) {
        callback(new Error('请输入正整数'));
      } else {
        callback();
      }
    };
    var validateNull = function validateNull(rule, value, callback) {
      if (_this.refund.receiver && !value) {
        callback(new Error('请选择实收日期'));
      } else {
        callback();
      }
    };
    var validateMoney = function validateMoney(rule, value, callback) {
      var reg = /^(([1-9]\d+(.[0-9]{1,4})?|\d(.[0-9]{1,4})?)|([-]([1-9]\d+(.[0-9]{1,4})?|\d(.[0-9]{1,4})?)))$/;
      if (_this.refund.receiver && !value) {
        callback(new Error('请再输入' + rule.labelname));
      } else if (_this.refund.receiver && !reg.test(value)) {
        callback(new Error('请再输入正确的' + rule.labelname));
      } else {
        callback();
      }
    };
    var nowDate = new Date();
    var beforeDate = new Date();
    beforeDate.setFullYear(nowDate.getFullYear() - 1);
    return {
      pickerOptions2: {
        shortcuts: [{
          text: '本月',
          onClick: function onClick(picker) {
            var end = new Date();
            var start = new Date(end.getFullYear() + "-" + (end.getMonth() + 1) + "-01");
            picker.$emit('pick', [start, end]);
          }
        }, {
          text: nowDate.getFullYear() + '年',
          onClick: function onClick(picker) {
            var end = new Date();
            var start = new Date(end.getFullYear() + "-01" + "-01");
            picker.$emit('pick', [start, end]);
          }
        }, {
          text: beforeDate.getFullYear() + '年',
          onClick: function onClick(picker) {
            var start = new Date(beforeDate.getFullYear() + "-01" + "-01");
            var end = new Date(beforeDate.getFullYear() + "-12" + "-31");
            picker.$emit('pick', [start, end]);
          }
        }]
      },
      refunds: [],
      refund: {
        refunds_real_time: null,
        refunds_should_money: "",
        refunds_real_money: "",
        refunds_policy_money: ""
      },
      refundRule: {
        refunds_real_time: [{ validator: validateNull, trigger: 'blur' }],
        refunds_should_money: [{ validator: validateMoney, labelname: '应付积分', trigger: 'blur' }],
        refunds_real_money: [{ validator: validateMoney, labelname: '实收积分', trigger: 'blur' }]
      },
      refundMoney: {
        rsm: 0,
        rrm: 0,
        sc: 0,
        own: 0
      }, //返费总额
      contacts: [],
      tags: [], //标签
      business: [],
      refundser: [], //返款人列表
      contactRefunders: [], //与当前联系人相关返款人列表
      pageNum: 10,
      currentPage: 1,
      count: 0,
      params: { //查询参数
        overdue: "",
        productCommonName: "",
        salesTime: [],
        returnTime: [],
        realReturnTime: [],
        contactId: "",
        status: "",
        business: "",
        product_code: "",
        refundser: "",
        tag: "",
        tag_type: [],
        hospitalsId: ""
      },
      hospitals: [],
      dialogFormVisible: false,
      loading: false,
      authCode: ""
    };
  },
  activated: function activated() {
    this.getRefundsList();
    this.getContacts();
    this.getProductBusiness();
    this.getSalesRefunder();
    this.getBankAccount();
    this.getHospitals();
    this.getTags();
    this.authCode = "," + JSON.parse(sessionStorage["user"]).authority_code;
  },
  mounted: function mounted() {},

  methods: {
    refundsPolicyMoney: function refundsPolicyMoney() {
      if (this.refund.refunds_policy_money) {
        this.refund.refunds_should_money = this.refund.refunds_policy_money * this.refund.sale_num;
      }
    },
    getHospitals: function getHospitals() {
      var _self = this;
      this.jquery('/iae/hospitals/getAllHospitals', { hospital_type: '销售单位' }, function (res) {
        _self.hospitals = res.message;
      });
    },
    getTags: function getTags() {
      var _self = this;
      this.jquery("/iae/tag/getAllTags", null, function (res) {
        //查询商业
        _self.tags = res.message.tagAll;
      });
    },
    deleteRow: function deleteRow(scope) {
      var _this2 = this;

      //删除
      this.$confirm('是否删除?', '提示', {
        confirmButtonText: '确定',
        cancelButtonText: '取消',
        type: 'warning'
      }).then(function () {
        _this2.deleteItem(scope);
      }).catch(function () {});
    },
    deleteItem: function deleteItem(scope) {
      var _self = this;
      this.jquery('/iae/refunds/deleteRefunds', {
        refunds_id: scope.row.refunds_id,
        refund_delete_flag: '1',
        sales_id: scope.row.sale_id
      }, function (res) {
        _self.$message({ showClose: true, message: '删除成功', type: 'success' });
        _self.getRefundsList();
        _self.dialogFormVisible = false;
      });
    },
    getSalesRefunder: function getSalesRefunder() {
      var _self = this;
      this.jquery("/iae/refunds/getSalesRefunder", null, function (res) {
        //查询返款人
        _self.refundser = res.message;
      });
    },
    getBankAccount: function getBankAccount() {
      var _self = this;
      this.jquery("/iae/bankaccount/getAllAccounts", null, function (res) {
        //查询账号
        _self.accounts = res.message;
      });
    },
    getProductBusiness: function getProductBusiness() {
      var _self = this;
      this.jquery("/iae/business/getAllBusiness", null, function (res) {
        //查询商业
        _self.business = res.message;
      });
    },
    getContacts: function getContacts() {
      var _self = this;
      this.jquery('/iae/contacts/getAllContacts', { group_id: 0, contact_type: ['佣金品种'] }, function (res) {
        _self.contacts = res.message;
      });
    },
    formatterMeondy: function formatterMeondy(row, column, cellValue) {
      var temp1 = this.sub(row.refunds_should_money, row.refunds_real_money, 4);
      var temp = this.sub(temp1, row.service_charge, 2);
      return temp;
    },
    formatterDate: function formatterDate(row, column, cellValue) {

      if (cellValue && typeof cellValue == "string") {
        var temp = cellValue.substring(0, 10);
        var d = new Date(temp);
        d.setDate(d.getDate() + 1);
        return d.format("yyyy-MM-dd");
      } else if (cellValue && (typeof cellValue === 'undefined' ? 'undefined' : _typeof(cellValue)) == "object") {
        return new Date(cellValue).format("yyyy-MM-dd");
      } else {
        return "";
      }
    },
    editRow: function editRow(scope) {
      //编辑返款信息
      //获取返款人信息
      var _self = this;
      this.jquery('/iae/refunds/getContactSalesRefunder', { contact_name: scope.row.contacts_name }, function (res) {
        _self.contactRefunders = res.message;
      });
      this.dialogFormVisible = true;
      if (this.$refs["refund"]) {
        this.$refs["refund"].resetFields();
      }
      var temp = JSON.stringify(scope.row);
      this.refund = JSON.parse(temp);
      this.refund.front_message = temp;
      this.refund.product_return_money = this.refund.hospital_policy_return_money ? this.refund.hospital_policy_return_money : this.refund.product_return_money;
      if (this.refund.product_return_money && !this.refund.refunds_should_money) {
        if (this.refund.product_floor_price && this.refund.product_high_discount && !this.refund.hospital_policy_return_money) {
          var rMoney = (this.refund.product_mack_price - this.refund.product_floor_price) * (1 - this.refund.product_high_discount / 100);
          this.refund.refunds_should_money = rMoney * this.refund.sale_num;
          this.refund.refunds_should_money = Math.round(this.refund.refunds_should_money * 100) / 100;
        } else {
          this.refund.refunds_should_money = this.mul(this.refund.product_return_money, this.refund.sale_num, 2);
        }
      }
    },
    handleSelect: function handleSelect(item) {
      this.refund.refundser = item.refundser;
    },
    querySearch: function querySearch(queryString, cb) {
      var receiver = this.contactRefunders;
      var results = queryString ? receiver.filter(this.createFilter(queryString)) : receiver;
      // 调用 callback 返回建议列表的数据
      cb(results);
    },
    createFilter: function createFilter(queryString) {
      return function (refundser) {
        if (refundser.refundser) {
          return refundser.refundser.toLowerCase().indexOf(queryString.toLowerCase()) > -1;
        } else {
          return;
        }
      };
    },
    reSearch: function reSearch(arg) {
      if (arg) {
        this.$refs["params"].resetFields();
        this.params.returnTime = [];
        this.params.realReturnTime = [];
      }
      this.currentPage = 1;
      this.getRefundsList();
    },
    exportRefundSale: function exportRefundSale() {
      var url = this.$bus.data.host + "/iae/refunds/exportRefundSale";
      this.download(url, this.params);
    },
    getRefundsList: function getRefundsList() {
      var _self = this;
      if (!_self.currentPage) {
        _self.currentPage = 1;
      }
      if (!_self.pageNum) {
        _self.pageNum = 10;
      }
      var page = {
        start: (_self.currentPage - 1) * _self.pageNum,
        limit: _self.pageNum
      };
      this.params.tag = this.params.tag_type[1];
      this.jquery('/iae/refunds/getSaleRefunds', {
        data: _self.params,
        page: page
      }, function (res) {
        _self.refunds = res.message.data;
        var own = res.message.rsm - res.message.rrm - res.message.sc;
        own = Math.round(own * 100) / 100;
        _self.refundMoney = {
          rrm: (res.message.rrm + "").replace(/\B(?=(\d{3})+(?!\d))/g, ','),
          rsm: (res.message.rsm + "").replace(/\B(?=(\d{3})+(?!\d))/g, ','),
          sc: (res.message.sc + "").replace(/\B(?=(\d{3})+(?!\d))/g, ','),
          own: (own + "").replace(/\B(?=(\d{3})+(?!\d))/g, ',')
        };
        _self.pageNum = parseInt(res.message.limit);
        _self.count = res.message.totalCount;
      });
    },
    editRefunds: function editRefunds(formName) {
      var _this3 = this;

      var _self = this;
      var url = this.refund.refunds_id ? "/iae/refunds/editRefunds" : "/iae/refunds/saveRefunds";
      this.$refs[formName].validate(function (valid) {
        if (valid) {
          _this3.loading = true;
          var accountDetail = _this3.formatterDate(null, null, _this3.refund.bill_date) + "销售" + _this3.refund.product_common_name + "收积分";
          var params = {
            refunds_should_time: _this3.refund.refunds_should_time,
            refunds_real_time: _this3.refund.refunds_real_time,
            refunds_should_money: _this3.refund.refunds_should_money,
            refunds_real_money: _this3.refund.refunds_real_money,
            refundser: _this3.refund.refundser,
            receiver: _this3.refund.receiver,
            refunds_id: _this3.refund.refunds_id,
            sales_id: _this3.refund.sale_id,
            service_charge: _this3.refund.service_charge,
            refunds_remark: _this3.refund.refunds_remark,
            front_message: _this3.refund.front_message,
            account_detail: accountDetail,
            refunds_policy_money: _this3.refund.refunds_policy_money

          };
          _self.jquery(url, params, function (res) {
            _self.dialogFormVisible = false;
            _self.loading = false;
            _self.$message({ showClose: true, message: '修改成功', type: 'success' });
            _self.getRefundsList();
          });
        } else {
          return false;
        }
      });
    },
    handleSizeChange: function handleSizeChange(val) {
      this.pageNum = val;
      this.currentPage = 1;
      this.getRefundsList();
    },
    handleCurrentChange: function handleCurrentChange(val) {
      this.currentPage = val;
      this.getRefundsList();
    }
  }
};

/***/ }),

/***/ 835:
/***/ (function(module, exports, __webpack_require__) {

module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('div', [_c('el-breadcrumb', {
    attrs: {
      "separator-class": "el-icon-arrow-right"
    }
  }, [_c('el-breadcrumb-item', [_vm._v("积分管理")]), _vm._v(" "), _c('el-breadcrumb-item', [_vm._v("销售应收管理")])], 1), _vm._v(" "), _c('el-form', {
    ref: "params",
    staticClass: "demo-form-inline search",
    attrs: {
      "inline": true,
      "model": _vm.params,
      "size": "mini"
    }
  }, [_c('div', [_c('el-form-item', {
    attrs: {
      "label": "销售日期",
      "prop": "salesTime"
    }
  }, [_c('el-date-picker', {
    attrs: {
      "type": "daterange",
      "size": "mini",
      "align": "right",
      "unlink-panels": "",
      "range-separator": "至",
      "start-placeholder": "开始日期",
      "end-placeholder": "结束日期",
      "picker-options": _vm.pickerOptions2
    },
    model: {
      value: (_vm.params.salesTime),
      callback: function($$v) {
        _vm.$set(_vm.params, "salesTime", $$v)
      },
      expression: "params.salesTime"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "应收日期",
      "prop": "returnTime"
    }
  }, [_c('el-date-picker', {
    attrs: {
      "type": "daterange",
      "size": "mini",
      "align": "right",
      "unlink-panels": "",
      "range-separator": "至",
      "start-placeholder": "开始日期",
      "end-placeholder": "结束日期",
      "picker-options": _vm.pickerOptions2
    },
    model: {
      value: (_vm.params.returnTime),
      callback: function($$v) {
        _vm.$set(_vm.params, "returnTime", $$v)
      },
      expression: "params.returnTime"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "实收日期",
      "prop": "realReturnTime"
    }
  }, [_c('el-date-picker', {
    attrs: {
      "type": "daterange",
      "size": "mini",
      "align": "right",
      "unlink-panels": "",
      "range-separator": "至",
      "start-placeholder": "开始日期",
      "end-placeholder": "结束日期",
      "picker-options": _vm.pickerOptions2
    },
    model: {
      value: (_vm.params.realReturnTime),
      callback: function($$v) {
        _vm.$set(_vm.params, "realReturnTime", $$v)
      },
      expression: "params.realReturnTime"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "产品名称",
      "prop": "productCommonName"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "size": "mini",
      "placeholder": "产品名称/助记码"
    },
    nativeOn: {
      "keyup": function($event) {
        if (!('button' in $event) && $event.keyCode !== 13) { return null; }
        _vm.reSearch(false)
      }
    },
    model: {
      value: (_vm.params.productCommonName),
      callback: function($$v) {
        _vm.$set(_vm.params, "productCommonName", $$v)
      },
      expression: "params.productCommonName"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "产品编码",
      "prop": "product_code"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "size": "mini",
      "placeholder": "产品编码"
    },
    nativeOn: {
      "keyup": function($event) {
        if (!('button' in $event) && $event.keyCode !== 13) { return null; }
        _vm.reSearch(false)
      }
    },
    model: {
      value: (_vm.params.product_code),
      callback: function($$v) {
        _vm.$set(_vm.params, "product_code", $$v)
      },
      expression: "params.product_code"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "　联系人",
      "prop": "contactId"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "filterable": "",
      "size": "mini",
      "placeholder": "请选择"
    },
    model: {
      value: (_vm.params.contactId),
      callback: function($$v) {
        _vm.$set(_vm.params, "contactId", $$v)
      },
      expression: "params.contactId"
    }
  }, [_c('el-option', {
    key: "",
    attrs: {
      "label": "全部",
      "value": ""
    }
  }), _vm._v(" "), _vm._l((_vm.contacts), function(item) {
    return _c('el-option', {
      key: item.contacts_id,
      attrs: {
        "label": item.contacts_name,
        "value": item.contacts_id
      }
    })
  })], 2)], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "销往单位",
      "prop": "hospitalsId"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "filterable": "",
      "size": "mini",
      "placeholder": "请选择"
    },
    model: {
      value: (_vm.params.hospitalsId),
      callback: function($$v) {
        _vm.$set(_vm.params, "hospitalsId", $$v)
      },
      expression: "params.hospitalsId"
    }
  }, [_c('el-option', {
    key: "",
    attrs: {
      "label": "全部",
      "value": ""
    }
  }), _vm._v(" "), _vm._l((_vm.hospitals), function(item) {
    return _c('el-option', {
      key: item.hospital_id,
      attrs: {
        "label": item.hospital_name,
        "value": item.hospital_id
      }
    })
  })], 2)], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "　　商业",
      "prop": "business"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "size": "mini",
      "filterable": "",
      "placeholder": "请选择商业"
    },
    model: {
      value: (_vm.params.business),
      callback: function($$v) {
        _vm.$set(_vm.params, "business", $$v)
      },
      expression: "params.business"
    }
  }, [_c('el-option', {
    key: "",
    attrs: {
      "label": "全部",
      "value": ""
    }
  }), _vm._v(" "), _vm._l((_vm.business), function(item) {
    return _c('el-option', {
      key: item.business_id,
      attrs: {
        "label": item.business_name,
        "value": item.business_id
      }
    })
  })], 2)], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "　　标签",
      "prop": "tag_type"
    }
  }, [_c('el-cascader', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "size": "mini",
      "placeholder": "搜索标签",
      "options": _vm.tags,
      "filterable": ""
    },
    model: {
      value: (_vm.params.tag_type),
      callback: function($$v) {
        _vm.$set(_vm.params, "tag_type", $$v)
      },
      expression: "params.tag_type"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "积分状态",
      "prop": "status"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "filterable": "",
      "size": "mini",
      "placeholder": "请选择"
    },
    model: {
      value: (_vm.params.status),
      callback: function($$v) {
        _vm.$set(_vm.params, "status", $$v)
      },
      expression: "params.status"
    }
  }, [_c('el-option', {
    key: "",
    attrs: {
      "label": "全部",
      "value": ""
    }
  }), _vm._v(" "), _c('el-option', {
    key: "已收",
    attrs: {
      "label": "已收",
      "value": "已收"
    }
  }), _vm._v(" "), _c('el-option', {
    key: "未收",
    attrs: {
      "label": "未收",
      "value": "未收"
    }
  })], 1)], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "付积分人",
      "prop": "refundser"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "filterable": "",
      "size": "mini",
      "placeholder": "请选择"
    },
    model: {
      value: (_vm.params.refundser),
      callback: function($$v) {
        _vm.$set(_vm.params, "refundser", $$v)
      },
      expression: "params.refundser"
    }
  }, [_c('el-option', {
    key: "",
    attrs: {
      "label": "全部",
      "value": ""
    }
  }), _vm._v(" "), _vm._l((_vm.refundser), function(item) {
    return (item.refundser) ? _c('el-option', {
      key: item.refundser,
      attrs: {
        "label": item.refundser,
        "value": item.refundser
      }
    }) : _vm._e()
  })], 2)], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "是否超期",
      "prop": "overdue"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "filterable": "",
      "size": "mini",
      "placeholder": "请选择"
    },
    model: {
      value: (_vm.params.overdue),
      callback: function($$v) {
        _vm.$set(_vm.params, "overdue", $$v)
      },
      expression: "params.overdue"
    }
  }, [_c('el-option', {
    key: "是",
    attrs: {
      "label": "是",
      "value": "是"
    }
  }), _vm._v(" "), _c('el-option', {
    key: "",
    attrs: {
      "label": "否",
      "value": ""
    }
  })], 1)], 1), _vm._v(" "), _c('el-form-item', [_c('el-button', {
    directives: [{
      name: "dbClick",
      rawName: "v-dbClick"
    }, {
      name: "show",
      rawName: "v-show",
      value: (_vm.authCode.indexOf(',46,') > -1),
      expression: "authCode.indexOf(',46,') > -1"
    }],
    staticStyle: {
      "margin-left": "14px"
    },
    attrs: {
      "type": "primary",
      "size": "mini"
    },
    on: {
      "click": function($event) {
        _vm.reSearch(false)
      }
    }
  }, [_vm._v("查询")]), _vm._v(" "), _c('el-button', {
    directives: [{
      name: "dbClick",
      rawName: "v-dbClick"
    }, {
      name: "show",
      rawName: "v-show",
      value: (_vm.authCode.indexOf(',46,') > -1),
      expression: "authCode.indexOf(',46,') > -1"
    }],
    attrs: {
      "type": "primary",
      "size": "mini"
    },
    on: {
      "click": function($event) {
        _vm.reSearch(true)
      }
    }
  }, [_vm._v("重置")]), _vm._v(" "), _c('el-button', {
    directives: [{
      name: "dbClick",
      rawName: "v-dbClick"
    }, {
      name: "show",
      rawName: "v-show",
      value: (_vm.authCode.indexOf(',105,') > -1),
      expression: "authCode.indexOf(',105,') > -1"
    }],
    attrs: {
      "type": "primary",
      "size": "mini"
    },
    on: {
      "click": _vm.exportRefundSale
    }
  }, [_vm._v("导出")])], 1)], 1)]), _vm._v(" "), _c('div', {
    staticClass: "sum_money"
  }, [_vm._v("\n      积分："), _c('a', [_vm._v(_vm._s(_vm.refundMoney.rsm))]), _vm._v("\n      已收积分："), _c('a', [_vm._v(_vm._s(_vm.refundMoney.rrm))]), _vm._v("\n      未收积分："), _c('a', [_vm._v(_vm._s(_vm.refundMoney.own))]), _vm._v("\n      其它积分："), _c('a', [_vm._v(_vm._s(_vm.refundMoney.sc))])]), _vm._v(" "), _c('el-table', {
    staticStyle: {
      "width": "100%"
    },
    attrs: {
      "data": _vm.refunds,
      "size": "mini",
      "stripe": true,
      "border": true
    }
  }, [_c('el-table-column', {
    attrs: {
      "fixed": "",
      "prop": "product_code",
      "label": "产品编码",
      "width": "100"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "fixed": "",
      "prop": "product_common_name",
      "label": "产品名称",
      "width": "120"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "product_specifications",
      "label": "产品规格",
      "width": "100"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "product_makesmakers",
      "label": "生产厂家",
      "width": "150"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "product_packing",
      "label": "包装",
      "width": "50"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "product_unit",
      "label": "单位",
      "width": "50"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "sale_price",
      "label": "中标价",
      "width": "60"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "sale_num",
      "label": "计划数量",
      "width": "70"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "sale_money",
      "label": "购入金额",
      "width": "70"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "business_name",
      "label": "商业",
      "width": "60"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "contacts_name",
      "label": "联系人",
      "width": "60"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "hospital_name",
      "label": "销往单位",
      "width": "140"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "bill_date",
      "label": "销售日期",
      "width": "80",
      "formatter": _vm.formatterDate
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "refunds_policy_money",
      "label": "积分",
      "width": "80"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "refunds_should_time",
      "label": "应收日期",
      "width": "80",
      "formatter": _vm.formatterDate
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "refunds_should_money",
      "label": "应收积分",
      "width": "80"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "refunds_real_time",
      "label": "实收日期",
      "width": "80",
      "formatter": _vm.formatterDate
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "refunds_real_money",
      "label": "实收积分",
      "width": "80"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "label": "未返积分",
      "width": "80",
      "formatter": _vm.formatterMeondy
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "service_charge",
      "label": "其它积分",
      "width": "60"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "refundser",
      "label": "付积分人",
      "width": "60"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "account_number",
      "label": "收积分账号",
      "width": "80"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "refunds_remark",
      "label": "备注",
      "width": "150"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "fixed": "right",
      "label": "操作",
      "width": "100"
    },
    scopedSlots: _vm._u([{
      key: "default",
      fn: function(scope) {
        return [_c('el-button', {
          directives: [{
            name: "show",
            rawName: "v-show",
            value: (_vm.authCode.indexOf(',103,') > -1),
            expression: "authCode.indexOf(',103,') > -1"
          }, {
            name: "dbClick",
            rawName: "v-dbClick"
          }],
          attrs: {
            "icon": "el-icon-delete",
            "type": "primary",
            "size": "mini"
          },
          nativeOn: {
            "click": function($event) {
              $event.preventDefault();
              _vm.deleteRow(scope)
            }
          }
        }), _vm._v(" "), _c('el-button', {
          directives: [{
            name: "show",
            rawName: "v-show",
            value: (_vm.authCode.indexOf(',47,') > -1),
            expression: "authCode.indexOf(',47,') > -1"
          }, {
            name: "dbClick",
            rawName: "v-dbClick"
          }],
          attrs: {
            "icon": "el-icon-edit-outline",
            "type": "primary",
            "size": "mini"
          },
          nativeOn: {
            "click": function($event) {
              $event.preventDefault();
              _vm.editRow(scope)
            }
          }
        })]
      }
    }])
  })], 1), _vm._v(" "), _c('div', {
    staticClass: "page_div"
  }, [_c('el-pagination', {
    attrs: {
      "background": "",
      "current-page": _vm.currentPage,
      "page-sizes": [5, 10, 50, 100],
      "page-size": _vm.pageNum,
      "layout": "total, sizes, prev, pager, next",
      "total": _vm.count
    },
    on: {
      "size-change": _vm.handleSizeChange,
      "current-change": _vm.handleCurrentChange
    }
  })], 1), _vm._v(" "), _c('el-dialog', {
    attrs: {
      "title": "更新积分记录",
      "width": "700px",
      "visible": _vm.dialogFormVisible
    },
    on: {
      "update:visible": function($event) {
        _vm.dialogFormVisible = $event
      }
    }
  }, [_c('el-collapse', {
    model: {
      value: (_vm.activeNames),
      callback: function($$v) {
        _vm.activeNames = $$v
      },
      expression: "activeNames"
    }
  }, [_c('el-collapse-item', {
    attrs: {
      "title": '药品信息（药品名：' + _vm.refund.product_common_name + '）',
      "name": "1"
    }
  }, [_c('div', [_c('span', [_vm._v("产品编号:")]), _vm._v(_vm._s(_vm.refund.product_code))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("产品规格:")]), _vm._v(_vm._s(_vm.refund.product_specifications))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("中标价:")]), _vm._v(_vm._s(_vm.refund.sale_price))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("销售数量:")]), _vm._v(_vm._s(_vm.refund.sale_num))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("积分:")]), _vm._v(_vm._s(_vm.refund.product_return_money))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("积分率:")]), _vm._v(_vm._s(_vm.refund.product_return_discount) + "%")]), _vm._v(" "), _c('div', {
    staticStyle: {
      "display": "block",
      "width": "100%"
    }
  }, [_c('span', [_vm._v("销售日期:")]), _vm._v(_vm._s(_vm.formatterDate(null, null, _vm.refund.bill_date + "")))]), _vm._v(" "), _c('div', {
    staticStyle: {
      "display": "block",
      "width": "100%"
    }
  }, [_c('span', [_vm._v("积分说明:")]), _vm._v(_vm._s(_vm.refund.product_return_explain))])])], 1), _vm._v(" "), _c('el-form', {
    ref: "refund",
    staticClass: "demo-ruleForm",
    staticStyle: {
      "margin-top": "20px"
    },
    attrs: {
      "model": _vm.refund,
      "status-icon": "",
      "rules": _vm.refundRule,
      "inline": true,
      "label-width": "100px"
    }
  }, [_c('el-form-item', {
    attrs: {
      "label": "应收日期",
      "prop": "refunds_should_time"
    }
  }, [_c('el-date-picker', {
    staticStyle: {
      "width": "194px"
    },
    attrs: {
      "type": "date",
      "placeholder": "请选择应付日期"
    },
    model: {
      value: (_vm.refund.refunds_should_time),
      callback: function($$v) {
        _vm.$set(_vm.refund, "refunds_should_time", $$v)
      },
      expression: "refund.refunds_should_time"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "积　　分",
      "prop": "refunds_policy_money"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "194px"
    },
    attrs: {
      "placeholder": "应付积分",
      "auto-complete": "off"
    },
    on: {
      "blur": _vm.refundsPolicyMoney
    },
    model: {
      value: (_vm.refund.refunds_policy_money),
      callback: function($$v) {
        _vm.$set(_vm.refund, "refunds_policy_money", $$v)
      },
      expression: "refund.refunds_policy_money"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "应收积分",
      "prop": "refunds_should_money"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "194px"
    },
    attrs: {
      "placeholder": "应付积分",
      "auto-complete": "off"
    },
    model: {
      value: (_vm.refund.refunds_should_money),
      callback: function($$v) {
        _vm.$set(_vm.refund, "refunds_should_money", $$v)
      },
      expression: "refund.refunds_should_money"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "实收日期",
      "prop": "refunds_real_time"
    }
  }, [_c('el-date-picker', {
    staticStyle: {
      "width": "194px"
    },
    attrs: {
      "type": "date",
      "placeholder": "请选择实收日期"
    },
    model: {
      value: (_vm.refund.refunds_real_time),
      callback: function($$v) {
        _vm.$set(_vm.refund, "refunds_real_time", $$v)
      },
      expression: "refund.refunds_real_time"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "实收积分",
      "prop": "refunds_real_money"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "194px"
    },
    attrs: {
      "placeholder": "实收积分",
      "auto-complete": "off"
    },
    model: {
      value: (_vm.refund.refunds_real_money),
      callback: function($$v) {
        _vm.$set(_vm.refund, "refunds_real_money", $$v)
      },
      expression: "refund.refunds_real_money"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "其它积分",
      "prop": "service_charge"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "194px"
    },
    attrs: {
      "placeholder": "其它积分",
      "auto-complete": "off"
    },
    model: {
      value: (_vm.refund.service_charge),
      callback: function($$v) {
        _vm.$set(_vm.refund, "service_charge", $$v)
      },
      expression: "refund.service_charge"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "付积分人",
      "prop": "refundser"
    }
  }, [_c('el-autocomplete', {
    staticStyle: {
      "width": "194px"
    },
    attrs: {
      "popper-class": "my-autocomplete",
      "fetch-suggestions": _vm.querySearch,
      "placeholder": "付积分人"
    },
    on: {
      "select": _vm.handleSelect
    },
    scopedSlots: _vm._u([{
      key: "default",
      fn: function(ref) {
        var item = ref.item;

        return [_c('div', {
          staticClass: "name"
        }, [_vm._v(_vm._s(item.refundser))])]
      }
    }]),
    model: {
      value: (_vm.refund.refundser),
      callback: function($$v) {
        _vm.$set(_vm.refund, "refundser", $$v)
      },
      expression: "refund.refundser"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "收积分账号",
      "prop": "receiver"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "194px"
    },
    attrs: {
      "filterable": "",
      "placeholder": "请选择"
    },
    model: {
      value: (_vm.refund.receiver),
      callback: function($$v) {
        _vm.$set(_vm.refund, "receiver", $$v)
      },
      expression: "refund.receiver"
    }
  }, [_c('el-option', {
    key: "",
    attrs: {
      "label": "请选择",
      "value": ""
    }
  }), _vm._v(" "), _vm._l((_vm.accounts), function(item) {
    return _c('el-option', {
      key: item.account_id,
      attrs: {
        "label": item.account_number,
        "value": item.account_id
      }
    })
  })], 2)], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "备注",
      "prop": "refunds_remark"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "194px"
    },
    attrs: {
      "placeholder": "备注",
      "auto-complete": "off"
    },
    model: {
      value: (_vm.refund.refunds_remark),
      callback: function($$v) {
        _vm.$set(_vm.refund, "refunds_remark", $$v)
      },
      expression: "refund.refunds_remark"
    }
  })], 1)], 1), _vm._v(" "), _c('div', {
    staticClass: "dialog-footer",
    attrs: {
      "slot": "footer"
    },
    slot: "footer"
  }, [_c('el-button', {
    directives: [{
      name: "dbClick",
      rawName: "v-dbClick"
    }],
    attrs: {
      "size": "small"
    },
    on: {
      "click": function($event) {
        _vm.dialogFormVisible = false
      }
    }
  }, [_vm._v("取 消")]), _vm._v(" "), _c('el-button', {
    directives: [{
      name: "dbClick",
      rawName: "v-dbClick"
    }],
    attrs: {
      "type": "primary",
      "size": "small",
      "loading": _vm.loading
    },
    on: {
      "click": function($event) {
        _vm.editRefunds('refund')
      }
    }
  }, [_vm._v("确 定")])], 1)], 1)], 1)
},staticRenderFns: []}
if (false) {
  module.hot.accept()
  if (module.hot.data) {
     require("vue-hot-reload-api").rerender("data-v-d0c9fea8", module.exports)
  }
}

/***/ }),

/***/ 836:
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__(837);
if(typeof content === 'string') content = [[module.i, content, '']];
// add the styles to the DOM
var update = __webpack_require__(91)(content, {});
if(content.locals) module.exports = content.locals;
// Hot Module Replacement
if(false) {
	// When the styles change, update the <style> tags
	if(!content.locals) {
		module.hot.accept("!!../../node_modules/css-loader/index.js!../../node_modules/vue-loader/lib/style-rewriter.js?id=data-v-b34c2c34!../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./refundpurchase.vue", function() {
			var newContent = require("!!../../node_modules/css-loader/index.js!../../node_modules/vue-loader/lib/style-rewriter.js?id=data-v-b34c2c34!../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./refundpurchase.vue");
			if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];
			update(newContent);
		});
	}
	// When the module is disposed, remove the <style> tags
	module.hot.dispose(function() { update(); });
}

/***/ }),

/***/ 837:
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__(2)();
// imports


// module
exports.push([module.i, "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", ""]);

// exports


/***/ }),

/***/ 838:
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//

exports.default = {
  data: function data() {
    var _this = this;

    var validateNum = function validateNum(rule, value, callback) {
      var regu = /^\+?[1-9][0-9]*$/;
      if (value === '') {
        callback(new Error('请输入计划数量'));
      } else if (!regu.test(value)) {
        callback(new Error('请输入正整数'));
      } else {
        callback();
      }
    };
    var validateNull = function validateNull(rule, value, callback) {
      if (_this.refund.receiver && !value) {
        callback(new Error('请选择实付日期'));
      } else {
        callback();
      }
    };
    var validateMoney = function validateMoney(rule, value, callback) {
      var reg = /^(([1-9]\d+(.[0-9]{1,4})?|\d(.[0-9]{1,4})?)|([-]([1-9]\d+(.[0-9]{1,4})?|\d(.[0-9]{1,4})?)))$/;
      if (_this.refund.receiver && !value) {
        callback(new Error('请再输入' + rule.labelname));
      } else if (_this.refund.receiver && !reg.test(value)) {
        callback(new Error('请再输入正确的' + rule.labelname));
      } else {
        callback();
      }
    };
    var nowDate = new Date();
    var beforeDate = new Date();
    beforeDate.setFullYear(nowDate.getFullYear() - 1);
    return {
      pickerOptions2: {
        shortcuts: [{
          text: '本月',
          onClick: function onClick(picker) {
            var end = new Date();
            var start = new Date(end.getFullYear() + "-" + (end.getMonth() + 1) + "-01");
            picker.$emit('pick', [start, end]);
          }
        }, {
          text: nowDate.getFullYear() + '年',
          onClick: function onClick(picker) {
            var end = new Date();
            var start = new Date(end.getFullYear() + "-01" + "-01");
            picker.$emit('pick', [start, end]);
          }
        }, {
          text: beforeDate.getFullYear() + '年',
          onClick: function onClick(picker) {
            var start = new Date(beforeDate.getFullYear() + "-01" + "-01");
            var end = new Date(beforeDate.getFullYear() + "-12" + "-31");
            picker.$emit('pick', [start, end]);
          }
        }]
      },
      purchases: [],
      contacts: [],
      business: [], //商业
      accounts: [], //收款人账号列表
      refundser: [], //返款人列表
      contactRefunders: [], //与当前联系人相关返款人列表
      refund: {
        refunds_real_time: null,
        refunds_should_money: "",
        refunds_real_money: "",
        refunds_policy_money: ""
      },
      refundRule: {
        refunds_real_time: [{ validator: validateNull, trigger: 'blur' }],
        refunds_should_money: [{ validator: validateMoney, labelname: '应返积分', trigger: 'blur' }],
        refunds_real_money: [{ validator: validateMoney, labelname: '实返积分', trigger: 'blur' }]
      },
      refundMoney: {
        rsm: 0,
        rrm: 0,
        sc: 0,
        own: 0
      }, //返费总额
      pageNum: 10,
      currentPage: 1,
      count: 0,
      params: { //查询参数
        overdue: "",
        productCommonName: "",
        time: [],
        returnTime: [],
        makeMoneyTime: [],
        realReturnTime: [],
        contactId: "",
        status: "",
        product_code: "",
        refundser: "",
        business: "",
        tag: "",
        tag_type: [],
        batch_number: "",
        makeMoneyFlag: "2"
      },
      tags: [], //标签
      dialogFormVisible: false,
      loading: false,
      authCode: ""
    };
  },
  activated: function activated() {
    this.getPurchasesList();
    this.getContacts();
    this.getPurchasesRefunder();
    this.getBankAccount();
    this.getProductBusiness();
    this.getTags();
    this.authCode = "," + JSON.parse(sessionStorage["user"]).authority_code;
  },
  mounted: function mounted() {},

  methods: {
    refundsPolicyMoney: function refundsPolicyMoney() {
      if (this.refund.refunds_policy_money) {
        this.refund.refunds_should_money = this.refund.refunds_policy_money * this.refund.purchase_number;
      }
    },
    getTags: function getTags() {
      var _self = this;
      this.jquery("/iae/tag/getAllTags", null, function (res) {
        //查询商业
        _self.tags = res.message.tagAll;
      });
    },
    deleteRow: function deleteRow(scope) {
      var _this2 = this;

      //删除
      this.$confirm('是否删除?', '提示', {
        confirmButtonText: '确定',
        cancelButtonText: '取消',
        type: 'warning'
      }).then(function () {
        _this2.deleteItem(scope);
      }).catch(function () {});
    },
    deleteItem: function deleteItem(scope) {
      var _self = this;
      this.jquery('/iae/refunds/deleteRefunds', {
        refunds_id: scope.row.refunds_id,
        refund_delete_flag: '1',
        purchases_id: scope.row.purchases_id
      }, function (res) {
        _self.$message({ showClose: true, message: '删除成功', type: 'success' });
        _self.getPurchasesList();
        _self.dialogFormVisible = false;
      });
    },
    getProductBusiness: function getProductBusiness() {
      var _self = this;
      this.jquery("/iae/business/getAllBusiness", null, function (res) {
        //查询商业
        _self.business = res.message;
      });
    },
    getPurchasesRefunder: function getPurchasesRefunder() {
      var _self = this;
      this.jquery("/iae/refunds/getPurchasesRefunder", null, function (res) {
        //查询返款人
        _self.refundser = res.message;
      });
    },
    getBankAccount: function getBankAccount() {
      var _self = this;
      this.jquery("/iae/bankaccount/getAllAccounts", null, function (res) {
        //查询返款人
        _self.accounts = res.message;
      });
    },
    getContacts: function getContacts() {
      var _self = this;
      this.jquery('/iae/contacts/getAllContacts', { group_id: 0, contact_type: ['高打品种'] }, function (res) {
        _self.contacts = res.message;
      });
    },
    formatterMeondy: function formatterMeondy(row, column, cellValue) {
      var temp1 = this.sub(row.refunds_should_money, row.refunds_real_money, 4);
      var temp = this.sub(temp1, row.service_charge, 2);
      return temp;
    },
    formatterDate: function formatterDate(row, column, cellValue) {
      if (cellValue && typeof cellValue == "string") {
        var temp = cellValue.substring(0, 10);
        var d = new Date(temp);
        d.setDate(d.getDate() + 1);
        return d.format("yyyy-MM-dd");
      } else if (cellValue && (typeof cellValue === 'undefined' ? 'undefined' : _typeof(cellValue)) == "object") {
        return new Date(cellValue).format("yyyy-MM-dd");
      } else {
        return "";
      }
    },
    editRow: function editRow(scope) {
      //编辑返款信息
      //获取返款人信息
      var _self = this;
      this.jquery('/iae/refunds/getContactPurchasesRefunder', { contact_name: scope.row.contacts_name }, function (res) {
        _self.contactRefunders = res.message;
      });

      this.dialogFormVisible = true;
      if (this.$refs["refund"]) {
        this.$refs["refund"].resetFields();
      }
      var temp = JSON.stringify(scope.row);
      this.refund = JSON.parse(temp);
      this.refund.front_message = temp;
      if (this.refund.product_return_money && !this.refund.refunds_should_money) {
        var num = this.refund.sale_num ? this.refund.sale_num : this.refund.purchase_number;
        if (this.refund.product_floor_price && this.refund.product_high_discount) {
          var rMoney = (this.refund.purchase_mack_price - this.refund.product_floor_price) * (1 - this.refund.product_high_discount / 100);
          this.refund.refunds_should_money = rMoney * num;
        } else {
          this.refund.refunds_should_money = this.refund.product_return_money * num;
        }
        this.refund.refunds_should_money = Math.round(this.refund.refunds_should_money * 100) / 100;
      }
    },
    handleSelect: function handleSelect(item) {
      this.refund.refundser = item.refundser;
    },
    querySearch: function querySearch(queryString, cb) {
      var receiver = this.contactRefunders;
      var results = queryString ? receiver.filter(this.createFilter(queryString)) : receiver;
      // 调用 callback 返回建议列表的数据
      cb(results);
    },
    createFilter: function createFilter(queryString) {
      return function (refundser) {
        if (refundser.refundser) {
          return refundser.refundser.toLowerCase().indexOf(queryString.toLowerCase()) > -1;
        } else {
          return;
        }
      };
    },
    reSearch: function reSearch(arg) {
      if (arg) {
        this.$refs["params"].resetFields();
        this.params.returnTime = [];
      }
      this.currentPage = 1;
      this.getPurchasesList();
    },
    exportRefundPurchase: function exportRefundPurchase() {
      var url = this.$bus.data.host + "/iae/refunds/exportRefundPurchase";
      this.download(url, this.params);
    },
    getPurchasesList: function getPurchasesList() {
      var _self = this;
      if (!_self.currentPage) {
        _self.currentPage = 1;
      }
      if (!_self.pageNum) {
        _self.pageNum = 10;
      }
      var page = {
        start: (_self.currentPage - 1) * _self.pageNum,
        limit: _self.pageNum
      };
      this.params.tag = this.params.tag_type[1];
      this.jquery('/iae/refunds/getPurchaseRefunds', {
        data: _self.params,
        page: page
      }, function (res) {
        _self.purchases = res.message.data;
        var own = res.message.rsm - res.message.rrm - res.message.sc;
        _self.refundMoney = {
          rrm: (res.message.rrm + "").replace(/\B(?=(\d{3})+(?!\d))/g, ','),
          rsm: (res.message.rsm + "").replace(/\B(?=(\d{3})+(?!\d))/g, ','),
          sc: (res.message.sc + "").replace(/\B(?=(\d{3})+(?!\d))/g, ','),
          own: (own.toFixed(2) + "").replace(/\B(?=(\d{3})+(?!\d))/g, ',')
        };
        _self.pageNum = parseInt(res.message.limit);
        _self.count = res.message.totalCount;
      });
    },
    editRefunds: function editRefunds(formName) {
      var _this3 = this;

      var _self = this;
      var url = this.refund.refunds_id ? "/iae/refunds/editRefunds" : "/iae/refunds/saveRefunds";
      this.$refs[formName].validate(function (valid) {
        if (valid) {
          _this3.loading = true;
          var accountDetail = _this3.formatterDate(null, null, _this3.refund.make_money_time) + "高打" + _this3.refund.product_common_name + "收积分";
          var params = {
            refunds_should_time: _this3.refund.refunds_should_time,
            refunds_real_time: _this3.refund.refunds_real_time,
            refunds_should_money: _this3.refund.refunds_should_money,
            refunds_real_money: _this3.refund.refunds_real_money,
            refundser: _this3.refund.refundser,
            receiver: _this3.refund.receiver,
            refunds_id: _this3.refund.refunds_id,
            purchases_id: _this3.refund.purchase_id,
            sales_id: _this3.refund.sale_id,
            service_charge: _this3.refund.service_charge,
            refunds_remark: _this3.refund.refunds_remark,
            front_message: _this3.refund.front_message,
            refunds_policy_money: _this3.refund.refunds_policy_money,
            account_detail: accountDetail
          };
          _self.jquery(url, params, function (res) {
            _self.dialogFormVisible = false;
            _self.loading = false;
            _self.$message({ showClose: true, message: '修改成功', type: 'success' });
            _self.getPurchasesList();
          });
        } else {
          return false;
        }
      });
    },
    handleSizeChange: function handleSizeChange(val) {
      this.pageNum = val;
      this.currentPage = 1;
      this.getPurchasesList();
    },
    handleCurrentChange: function handleCurrentChange(val) {
      this.currentPage = val;
      this.getPurchasesList();
    }
  }
};

/***/ }),

/***/ 839:
/***/ (function(module, exports, __webpack_require__) {

module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('div', [_c('el-breadcrumb', {
    attrs: {
      "separator-class": "el-icon-arrow-right"
    }
  }, [_c('el-breadcrumb-item', [_vm._v("积分管理")]), _vm._v(" "), _c('el-breadcrumb-item', [_vm._v("采进应收管理")])], 1), _vm._v(" "), _c('el-form', {
    ref: "params",
    staticClass: "demo-form-inline search",
    attrs: {
      "inline": true,
      "model": _vm.params,
      "size": "mini"
    }
  }, [_c('div', [_c('el-form-item', {
    attrs: {
      "label": "备货日期",
      "prop": "time"
    }
  }, [_c('el-date-picker', {
    attrs: {
      "type": "daterange",
      "size": "mini",
      "align": "right",
      "unlink-panels": "",
      "range-separator": "至",
      "start-placeholder": "开始日期",
      "end-placeholder": "结束日期",
      "picker-options": _vm.pickerOptions2
    },
    model: {
      value: (_vm.params.time),
      callback: function($$v) {
        _vm.$set(_vm.params, "time", $$v)
      },
      expression: "params.time"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "打款日期",
      "prop": "makeMoneyTime"
    }
  }, [_c('el-date-picker', {
    attrs: {
      "type": "daterange",
      "size": "mini",
      "align": "right",
      "unlink-panels": "",
      "range-separator": "至",
      "start-placeholder": "开始日期",
      "end-placeholder": "结束日期",
      "picker-options": _vm.pickerOptions2
    },
    model: {
      value: (_vm.params.makeMoneyTime),
      callback: function($$v) {
        _vm.$set(_vm.params, "makeMoneyTime", $$v)
      },
      expression: "params.makeMoneyTime"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "应收日期",
      "prop": "returnTime"
    }
  }, [_c('el-date-picker', {
    attrs: {
      "type": "daterange",
      "size": "mini",
      "align": "right",
      "unlink-panels": "",
      "range-separator": "至",
      "start-placeholder": "开始日期",
      "end-placeholder": "结束日期",
      "picker-options": _vm.pickerOptions2
    },
    model: {
      value: (_vm.params.returnTime),
      callback: function($$v) {
        _vm.$set(_vm.params, "returnTime", $$v)
      },
      expression: "params.returnTime"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "实收日期",
      "prop": "realReturnTime"
    }
  }, [_c('el-date-picker', {
    attrs: {
      "type": "daterange",
      "size": "mini",
      "align": "right",
      "unlink-panels": "",
      "range-separator": "至",
      "start-placeholder": "开始日期",
      "end-placeholder": "结束日期",
      "picker-options": _vm.pickerOptions2
    },
    model: {
      value: (_vm.params.realReturnTime),
      callback: function($$v) {
        _vm.$set(_vm.params, "realReturnTime", $$v)
      },
      expression: "params.realReturnTime"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "产品名称",
      "prop": "productCommonName"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "size": "mini",
      "placeholder": "产品名称/助记码"
    },
    nativeOn: {
      "keyup": function($event) {
        if (!('button' in $event) && $event.keyCode !== 13) { return null; }
        _vm.reSearch(false)
      }
    },
    model: {
      value: (_vm.params.productCommonName),
      callback: function($$v) {
        _vm.$set(_vm.params, "productCommonName", $$v)
      },
      expression: "params.productCommonName"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "产品编码",
      "prop": "product_code"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "size": "mini",
      "placeholder": "产品编码"
    },
    nativeOn: {
      "keyup": function($event) {
        if (!('button' in $event) && $event.keyCode !== 13) { return null; }
        _vm.reSearch(false)
      }
    },
    model: {
      value: (_vm.params.product_code),
      callback: function($$v) {
        _vm.$set(_vm.params, "product_code", $$v)
      },
      expression: "params.product_code"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "　　批号",
      "prop": "batch_number"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "size": "mini",
      "placeholder": "批号"
    },
    nativeOn: {
      "keyup": function($event) {
        if (!('button' in $event) && $event.keyCode !== 13) { return null; }
        _vm.reSearch(false)
      }
    },
    model: {
      value: (_vm.params.batch_number),
      callback: function($$v) {
        _vm.$set(_vm.params, "batch_number", $$v)
      },
      expression: "params.batch_number"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "　联系人",
      "prop": "contactId"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "filterable": "",
      "size": "mini",
      "placeholder": "请选择"
    },
    model: {
      value: (_vm.params.contactId),
      callback: function($$v) {
        _vm.$set(_vm.params, "contactId", $$v)
      },
      expression: "params.contactId"
    }
  }, [_c('el-option', {
    key: "",
    attrs: {
      "label": "全部",
      "value": ""
    }
  }), _vm._v(" "), _vm._l((_vm.contacts), function(item) {
    return _c('el-option', {
      key: item.contacts_id,
      attrs: {
        "label": item.contacts_name,
        "value": item.contacts_id
      }
    })
  })], 2)], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "　　商业",
      "prop": "business"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "size": "mini",
      "filterable": "",
      "placeholder": "请选择商业"
    },
    model: {
      value: (_vm.params.business),
      callback: function($$v) {
        _vm.$set(_vm.params, "business", $$v)
      },
      expression: "params.business"
    }
  }, [_c('el-option', {
    key: "",
    attrs: {
      "label": "全部",
      "value": ""
    }
  }), _vm._v(" "), _vm._l((_vm.business), function(item) {
    return _c('el-option', {
      key: item.business_id,
      attrs: {
        "label": item.business_name,
        "value": item.business_id
      }
    })
  })], 2)], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "　　标签",
      "prop": "tag_type"
    }
  }, [_c('el-cascader', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "size": "mini",
      "placeholder": "搜索标签",
      "options": _vm.tags,
      "filterable": ""
    },
    model: {
      value: (_vm.params.tag_type),
      callback: function($$v) {
        _vm.$set(_vm.params, "tag_type", $$v)
      },
      expression: "params.tag_type"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "积分状态",
      "prop": "status"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "filterable": "",
      "size": "mini",
      "placeholder": "请选择"
    },
    model: {
      value: (_vm.params.status),
      callback: function($$v) {
        _vm.$set(_vm.params, "status", $$v)
      },
      expression: "params.status"
    }
  }, [_c('el-option', {
    key: "",
    attrs: {
      "label": "全部",
      "value": ""
    }
  }), _vm._v(" "), _c('el-option', {
    key: "已收",
    attrs: {
      "label": "已收",
      "value": "已收"
    }
  }), _vm._v(" "), _c('el-option', {
    key: "未收",
    attrs: {
      "label": "未收",
      "value": "未收"
    }
  })], 1)], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "付积分人",
      "prop": "refundser"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "filterable": "",
      "size": "mini",
      "placeholder": "请选择"
    },
    model: {
      value: (_vm.params.refundser),
      callback: function($$v) {
        _vm.$set(_vm.params, "refundser", $$v)
      },
      expression: "params.refundser"
    }
  }, [_c('el-option', {
    key: "",
    attrs: {
      "label": "全部",
      "value": ""
    }
  }), _vm._v(" "), _vm._l((_vm.refundser), function(item) {
    return (item.refundser) ? _c('el-option', {
      key: item.refundser,
      attrs: {
        "label": item.refundser,
        "value": item.refundser
      }
    }) : _vm._e()
  })], 2)], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "是否超期",
      "prop": "overdue"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "filterable": "",
      "size": "mini",
      "placeholder": "请选择"
    },
    model: {
      value: (_vm.params.overdue),
      callback: function($$v) {
        _vm.$set(_vm.params, "overdue", $$v)
      },
      expression: "params.overdue"
    }
  }, [_c('el-option', {
    key: "是",
    attrs: {
      "label": "是",
      "value": "是"
    }
  }), _vm._v(" "), _c('el-option', {
    key: "",
    attrs: {
      "label": "否",
      "value": ""
    }
  })], 1)], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "是否打款",
      "prop": "makeMoneyFlag"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "filterable": "",
      "size": "mini",
      "placeholder": "请选择"
    },
    model: {
      value: (_vm.params.makeMoneyFlag),
      callback: function($$v) {
        _vm.$set(_vm.params, "makeMoneyFlag", $$v)
      },
      expression: "params.makeMoneyFlag"
    }
  }, [_c('el-option', {
    key: "2",
    attrs: {
      "label": "是",
      "value": "2"
    }
  }), _vm._v(" "), _c('el-option', {
    key: "",
    attrs: {
      "label": "全部",
      "value": ""
    }
  })], 1)], 1), _vm._v(" "), _c('el-form-item', [_c('el-button', {
    directives: [{
      name: "dbClick",
      rawName: "v-dbClick"
    }, {
      name: "show",
      rawName: "v-show",
      value: (_vm.authCode.indexOf(',44,') > -1),
      expression: "authCode.indexOf(',44,') > -1"
    }],
    staticStyle: {
      "margin-left": "14px"
    },
    attrs: {
      "type": "primary",
      "size": "mini"
    },
    on: {
      "click": function($event) {
        _vm.reSearch(false)
      }
    }
  }, [_vm._v("查询")]), _vm._v(" "), _c('el-button', {
    directives: [{
      name: "dbClick",
      rawName: "v-dbClick"
    }, {
      name: "show",
      rawName: "v-show",
      value: (_vm.authCode.indexOf(',44,') > -1),
      expression: "authCode.indexOf(',44,') > -1"
    }],
    attrs: {
      "type": "primary",
      "size": "mini"
    },
    on: {
      "click": function($event) {
        _vm.reSearch(true)
      }
    }
  }, [_vm._v("重置")]), _vm._v(" "), _c('el-button', {
    directives: [{
      name: "dbClick",
      rawName: "v-dbClick"
    }, {
      name: "show",
      rawName: "v-show",
      value: (_vm.authCode.indexOf(',106,') > -1),
      expression: "authCode.indexOf(',106,') > -1"
    }],
    attrs: {
      "type": "primary",
      "size": "mini"
    },
    on: {
      "click": _vm.exportRefundPurchase
    }
  }, [_vm._v("导出")])], 1)], 1)]), _vm._v(" "), _c('div', {
    staticClass: "sum_money"
  }, [_vm._v("\n      积分："), _c('a', [_vm._v(_vm._s(_vm.refundMoney.rsm))]), _vm._v("\n      实收积分："), _c('a', [_vm._v(_vm._s(_vm.refundMoney.rrm))]), _vm._v("\n      未收积分："), _c('a', [_vm._v(_vm._s(_vm.refundMoney.own))]), _vm._v("\n      其它积分："), _c('a', [_vm._v(_vm._s(_vm.refundMoney.sc))])]), _vm._v(" "), _c('el-table', {
    staticStyle: {
      "width": "100%"
    },
    attrs: {
      "data": _vm.purchases,
      "size": "mini",
      "stripe": true,
      "border": true
    }
  }, [_c('el-table-column', {
    attrs: {
      "fixed": "",
      "prop": "product_code",
      "label": "产品编码",
      "width": "100"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "fixed": "",
      "prop": "product_common_name",
      "label": "产品名称",
      "width": "120"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "product_specifications",
      "label": "产品规格",
      "width": "100"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "product_makesmakers",
      "label": "生产厂家",
      "width": "150"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "product_packing",
      "label": "包装",
      "width": "50"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "product_unit",
      "label": "单位",
      "width": "50"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "purchase_price",
      "label": "中标价",
      "width": "60"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "purchase_number",
      "label": "购入数量",
      "width": "70"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "purchase_money",
      "label": "购入金额",
      "width": "70"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "batch_number",
      "label": "批号",
      "width": "70"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "business_name",
      "label": "商业",
      "width": "60"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "contacts_name",
      "label": "联系人",
      "width": "60"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "time",
      "label": "备货日期",
      "width": "80",
      "formatter": _vm.formatterDate
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "make_money_time",
      "label": "打款日期",
      "width": "80",
      "formatter": _vm.formatterDate
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "send_out_time",
      "label": "发货日期",
      "width": "80",
      "formatter": _vm.formatterDate
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "refunds_policy_money",
      "label": "积分",
      "width": "80"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "refunds_should_time",
      "label": "应收日期",
      "width": "80",
      "formatter": _vm.formatterDate
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "refunds_should_money",
      "label": "应收积分",
      "width": "80"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "refunds_real_time",
      "label": "实收日期",
      "width": "80",
      "formatter": _vm.formatterDate
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "refunds_real_money",
      "label": "实收积分",
      "width": "70"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "service_charge",
      "label": "其它积分",
      "width": "60"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "label": "未收积分",
      "width": "80",
      "formatter": _vm.formatterMeondy
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "refundser",
      "label": "付积分人",
      "width": "60"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "account_number",
      "label": "收积分账号",
      "width": "80"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "refunds_remark",
      "label": "备注",
      "width": "150"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "fixed": "right",
      "label": "操作",
      "width": "100"
    },
    scopedSlots: _vm._u([{
      key: "default",
      fn: function(scope) {
        return [_c('el-button', {
          directives: [{
            name: "show",
            rawName: "v-show",
            value: (_vm.authCode.indexOf(',104,') > -1),
            expression: "authCode.indexOf(',104,') > -1"
          }, {
            name: "dbClick",
            rawName: "v-dbClick"
          }],
          attrs: {
            "icon": "el-icon-delete",
            "type": "primary",
            "size": "mini"
          },
          nativeOn: {
            "click": function($event) {
              $event.preventDefault();
              _vm.deleteRow(scope)
            }
          }
        }), _vm._v(" "), _c('el-button', {
          directives: [{
            name: "show",
            rawName: "v-show",
            value: (_vm.authCode.indexOf(',45,') > -1),
            expression: "authCode.indexOf(',45,') > -1"
          }, {
            name: "dbClick",
            rawName: "v-dbClick"
          }],
          attrs: {
            "size": "mini",
            "icon": "el-icon-edit-outline",
            "type": "primary"
          },
          nativeOn: {
            "click": function($event) {
              $event.preventDefault();
              _vm.editRow(scope)
            }
          }
        })]
      }
    }])
  })], 1), _vm._v(" "), _c('div', {
    staticClass: "page_div"
  }, [_c('el-pagination', {
    attrs: {
      "background": "",
      "current-page": _vm.currentPage,
      "page-sizes": [5, 10, 50, 100],
      "page-size": _vm.pageNum,
      "layout": "total, sizes, prev, pager, next",
      "total": _vm.count
    },
    on: {
      "size-change": _vm.handleSizeChange,
      "current-change": _vm.handleCurrentChange
    }
  })], 1), _vm._v(" "), _c('el-dialog', {
    attrs: {
      "title": "更新积分记录",
      "width": "700px",
      "visible": _vm.dialogFormVisible
    },
    on: {
      "update:visible": function($event) {
        _vm.dialogFormVisible = $event
      }
    }
  }, [_c('el-collapse', {
    model: {
      value: (_vm.activeNames),
      callback: function($$v) {
        _vm.activeNames = $$v
      },
      expression: "activeNames"
    }
  }, [_c('el-collapse-item', {
    attrs: {
      "title": '药品信息（药品名：' + _vm.refund.product_common_name + '）',
      "name": "1"
    }
  }, [_c('div', [_c('span', [_vm._v("产品规格:")]), _vm._v(_vm._s(_vm.refund.product_specifications))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("中标价:")]), _vm._v(_vm._s(_vm.refund.purchase_price))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("打款价:")]), _vm._v(_vm._s(_vm.refund.purchase_mack_price))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("购入数量:")]), _vm._v(_vm._s(_vm.refund.purchase_number))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("积分:")]), _vm._v(_vm._s(_vm.refund.product_return_money))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("打款时间:")]), _vm._v(_vm._s(_vm.refund.make_money_time ? new Date(_vm.refund.make_money_time).format("yyyy-MM-dd") : ""))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("发货时间:")]), _vm._v(_vm._s(_vm.refund.send_out_time ? new Date(_vm.refund.send_out_time).format("yyyy-MM-dd") : ""))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("积分率:")]), _vm._v(_vm._s(_vm.refund.product_return_discount) + "%")]), _vm._v(" "), _c('div', {
    staticStyle: {
      "display": "block",
      "width": "100%"
    }
  }, [_c('span', [_vm._v("积分说明:")]), _vm._v(_vm._s(_vm.refund.product_return_explain))])])], 1), _vm._v(" "), _c('el-form', {
    ref: "refund",
    staticClass: "demo-ruleForm",
    staticStyle: {
      "margin-top": "20px"
    },
    attrs: {
      "model": _vm.refund,
      "status-icon": "",
      "inline": true,
      "rules": _vm.refundRule,
      "label-width": "100px"
    }
  }, [_c('el-form-item', {
    attrs: {
      "label": "应收日期",
      "prop": "refunds_should_time"
    }
  }, [_c('el-date-picker', {
    staticStyle: {
      "width": "194px"
    },
    attrs: {
      "type": "date",
      "placeholder": "请选择应付日期"
    },
    model: {
      value: (_vm.refund.refunds_should_time),
      callback: function($$v) {
        _vm.$set(_vm.refund, "refunds_should_time", $$v)
      },
      expression: "refund.refunds_should_time"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "积　　分",
      "prop": "refunds_policy_money"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "194px"
    },
    attrs: {
      "placeholder": "应付积分",
      "auto-complete": "off"
    },
    on: {
      "blur": _vm.refundsPolicyMoney
    },
    model: {
      value: (_vm.refund.refunds_policy_money),
      callback: function($$v) {
        _vm.$set(_vm.refund, "refunds_policy_money", $$v)
      },
      expression: "refund.refunds_policy_money"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "应收积分",
      "prop": "refunds_should_money"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "194px"
    },
    attrs: {
      "placeholder": "应付积分",
      "auto-complete": "off"
    },
    model: {
      value: (_vm.refund.refunds_should_money),
      callback: function($$v) {
        _vm.$set(_vm.refund, "refunds_should_money", $$v)
      },
      expression: "refund.refunds_should_money"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "实收日期",
      "prop": "refunds_real_time"
    }
  }, [_c('el-date-picker', {
    staticStyle: {
      "width": "194px"
    },
    attrs: {
      "type": "date",
      "placeholder": "请选择实收日期"
    },
    model: {
      value: (_vm.refund.refunds_real_time),
      callback: function($$v) {
        _vm.$set(_vm.refund, "refunds_real_time", $$v)
      },
      expression: "refund.refunds_real_time"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "实收积分",
      "prop": "refunds_real_money"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "194px"
    },
    attrs: {
      "placeholder": "实收积分",
      "auto-complete": "off"
    },
    model: {
      value: (_vm.refund.refunds_real_money),
      callback: function($$v) {
        _vm.$set(_vm.refund, "refunds_real_money", $$v)
      },
      expression: "refund.refunds_real_money"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "其它积分",
      "prop": "service_charge"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "194px"
    },
    attrs: {
      "placeholder": "其它积分",
      "auto-complete": "off"
    },
    model: {
      value: (_vm.refund.service_charge),
      callback: function($$v) {
        _vm.$set(_vm.refund, "service_charge", $$v)
      },
      expression: "refund.service_charge"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "付积分人",
      "prop": "refundser"
    }
  }, [_c('el-autocomplete', {
    staticStyle: {
      "width": "194px"
    },
    attrs: {
      "popper-class": "my-autocomplete",
      "fetch-suggestions": _vm.querySearch,
      "placeholder": "付积分人"
    },
    on: {
      "select": _vm.handleSelect
    },
    scopedSlots: _vm._u([{
      key: "default",
      fn: function(ref) {
        var item = ref.item;

        return [_c('div', {
          staticClass: "name"
        }, [_vm._v(_vm._s(item.refundser))])]
      }
    }]),
    model: {
      value: (_vm.refund.refundser),
      callback: function($$v) {
        _vm.$set(_vm.refund, "refundser", $$v)
      },
      expression: "refund.refundser"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "收积分账号",
      "prop": "receiver"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "194px"
    },
    attrs: {
      "filterable": "",
      "placeholder": "请选择"
    },
    model: {
      value: (_vm.refund.receiver),
      callback: function($$v) {
        _vm.$set(_vm.refund, "receiver", $$v)
      },
      expression: "refund.receiver"
    }
  }, [_c('el-option', {
    key: "",
    attrs: {
      "label": "请选择",
      "value": ""
    }
  }), _vm._v(" "), _vm._l((_vm.accounts), function(item) {
    return _c('el-option', {
      key: item.account_id,
      attrs: {
        "label": item.account_number,
        "value": item.account_id
      }
    })
  })], 2)], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "备注",
      "prop": "refunds_remark"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "194px"
    },
    attrs: {
      "placeholder": "备注",
      "auto-complete": "off"
    },
    model: {
      value: (_vm.refund.refunds_remark),
      callback: function($$v) {
        _vm.$set(_vm.refund, "refunds_remark", $$v)
      },
      expression: "refund.refunds_remark"
    }
  })], 1)], 1), _vm._v(" "), _c('div', {
    staticClass: "dialog-footer",
    attrs: {
      "slot": "footer"
    },
    slot: "footer"
  }, [_c('el-button', {
    directives: [{
      name: "dbClick",
      rawName: "v-dbClick"
    }],
    attrs: {
      "size": "small"
    },
    on: {
      "click": function($event) {
        _vm.dialogFormVisible = false
      }
    }
  }, [_vm._v("取 消")]), _vm._v(" "), _c('el-button', {
    directives: [{
      name: "dbClick",
      rawName: "v-dbClick"
    }],
    attrs: {
      "type": "primary",
      "size": "small",
      "loading": _vm.loading
    },
    on: {
      "click": function($event) {
        _vm.editRefunds('refund')
      }
    }
  }, [_vm._v("确 定")])], 1)], 1)], 1)
},staticRenderFns: []}
if (false) {
  module.hot.accept()
  if (module.hot.data) {
     require("vue-hot-reload-api").rerender("data-v-b34c2c34", module.exports)
  }
}

/***/ }),

/***/ 84:
/***/ (function(module, exports, __webpack_require__) {

var __vue_exports__, __vue_options__
var __vue_styles__ = {}

/* styles */
__webpack_require__(844)

/* script */
__vue_exports__ = __webpack_require__(846)

/* template */
var __vue_template__ = __webpack_require__(847)
__vue_options__ = __vue_exports__ = __vue_exports__ || {}
if (
  typeof __vue_exports__.default === "object" ||
  typeof __vue_exports__.default === "function"
) {
if (Object.keys(__vue_exports__).some(function (key) { return key !== "default" && key !== "__esModule" })) {console.error("named exports are not supported in *.vue files.")}
__vue_options__ = __vue_exports__ = __vue_exports__.default
}
if (typeof __vue_options__ === "function") {
  __vue_options__ = __vue_options__.options
}
__vue_options__.__file = "/Users/lvyang/workspace/iae/views/sales/salesReturnMoney.vue"
__vue_options__.render = __vue_template__.render
__vue_options__.staticRenderFns = __vue_template__.staticRenderFns

/* hot reload */
if (false) {(function () {
  var hotAPI = require("vue-hot-reload-api")
  hotAPI.install(require("vue"), false)
  if (!hotAPI.compatible) return
  module.hot.accept()
  if (!module.hot.data) {
    hotAPI.createRecord("data-v-4662f180", __vue_options__)
  } else {
    hotAPI.reload("data-v-4662f180", __vue_options__)
  }
})()}
if (__vue_options__.functional) {console.error("[vue-loader] salesReturnMoney.vue: functional components are not supported and should be defined in plain js files using render functions.")}

module.exports = __vue_exports__


/***/ }),

/***/ 840:
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__(841);
if(typeof content === 'string') content = [[module.i, content, '']];
// add the styles to the DOM
var update = __webpack_require__(91)(content, {});
if(content.locals) module.exports = content.locals;
// Hot Module Replacement
if(false) {
	// When the styles change, update the <style> tags
	if(!content.locals) {
		module.hot.accept("!!../../node_modules/css-loader/index.js!../../node_modules/vue-loader/lib/style-rewriter.js?id=data-v-6b355fcc!../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./allotReturnMoney.vue", function() {
			var newContent = require("!!../../node_modules/css-loader/index.js!../../node_modules/vue-loader/lib/style-rewriter.js?id=data-v-6b355fcc!../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./allotReturnMoney.vue");
			if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];
			update(newContent);
		});
	}
	// When the module is disposed, remove the <style> tags
	module.hot.dispose(function() { update(); });
}

/***/ }),

/***/ 841:
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__(2)();
// imports


// module
exports.push([module.i, "\n.sum_money_allot > a{\n\tpadding-left: 20px;\n\tcolor: #606266;\n}\n.sum_money_allot > span{\n\tcolor:#606266;\n}\n.sum_money_allot .more_detail{\n\tposition: absolute;\n\tright: 10px;\n\theight: 30px;\n\tline-height: 30px;\n\tcolor: #409EFF;\n\ttext-decoration: none;\n}\n.sum_money_allot{\n\tposition: relative;\n\tbackground-color: #fff;\n\tborder-bottom: 1px solid #ebeef5;\n\theight: 30px;\n\tcolor:#f24040;\n\tline-height: 30px;\n\tfont-size: 14px;\n}\n", ""]);

// exports


/***/ }),

/***/ 842:
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
	value: true
});

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//

exports.default = {
	data: function data() {
		var _this = this;

		var reg = /(^[1-9]([0-9]+)?(\.[0-9]{1,2})?$)|(^(0){1}$)|(^[0-9]\.[0-9]([0-9])?$)/;
		var validateNum = function validateNum(rule, value, callback) {
			var regu = /^\+?[1-9][0-9]*$/;
			if (value === '') {
				callback(new Error('请输入调货数量'));
			} else if (!regu.test(value)) {
				callback(new Error('请输入正整数'));
			} else {
				_this.allot.allot_money = _this.mul(_this.allot.allot_number, _this.allot.allot_price, 2);
				if (_this.allot.allot_return_price && reg.test(_this.allot.allot_return_price)) {
					_this.allot.allot_return_money = _this.allot.allot_return_money ? _this.allot.allot_return_money : _this.mul(_this.allot.allot_return_price, _this.allot.allot_number, 2);
				}
				callback();
			}
		};
		var validateNull = function validateNull(rule, value, callback) {
			if (_this.allot.allot_return_flag && !value) {
				callback(new Error('请选择' + rule.labelname));
			} else {
				callback();
			}
		};
		var validateRealReturnMoney = function validateRealReturnMoney(rule, value, callback) {
			if (_this.allot.allot_return_flag && !value) {
				callback(new Error('请输入政策积分'));
			} else if (_this.allot.allot_return_flag && value && !reg.test(value)) {
				callback(new Error('请输入正确的政策积分'));
			} else {
				_this.allot.allot_return_money = _this.mul(value, _this.allot.allot_number, 2);
				_this.allot.allot_return_money = _this.allot.other_monety_temp ? _this.sub(_this.allot.allot_return_money, _this.allot.other_monety_temp, 2) : _this.allot.allot_return_money;
				callback();
			}
		};
		var nowDate = new Date();
		var beforeDate = new Date();
		beforeDate.setFullYear(nowDate.getFullYear() - 1);
		return {
			pickerOptions2: {
				shortcuts: [{
					text: '本月',
					onClick: function onClick(picker) {
						var end = new Date();
						var start = new Date(end.getFullYear() + "-" + (end.getMonth() + 1) + "-01");
						picker.$emit('pick', [start, end]);
					}
				}, {
					text: nowDate.getFullYear() + '年',
					onClick: function onClick(picker) {
						var end = new Date();
						var start = new Date(end.getFullYear() + "-01" + "-01");
						picker.$emit('pick', [start, end]);
					}
				}, {
					text: beforeDate.getFullYear() + '年',
					onClick: function onClick(picker) {
						var start = new Date(beforeDate.getFullYear() + "-01" + "-01");
						var end = new Date(beforeDate.getFullYear() + "-12" + "-31");
						picker.$emit('pick', [start, end]);
					}
				}]
			},
			allots: [],
			allot: {},
			hospitals: [],
			contacts: [],
			business: [],
			loading: false,
			money: 0, //总额统计
			money1: 0, //已付金额统计
			money2: 0, //未付金额统计
			pageNum: 10,
			currentPage: 1,
			count: 0,
			dialogFormVisible: false,
			params: {
				productCommonName: "",
				allot_hospital: "",
				allot_time: [],
				allotReturnTime: [],
				product_code: "",
				allot_return_flag: "",
				business: "",
				contactId: ""
			},
			allotRule: {
				allot_account_id: [{ validator: validateNull, labelname: '回款账号', trigger: 'change' }],
				allot_return_time: [{ validator: validateNull, labelname: '回款时间', trigger: 'change' }],
				allot_return_price: [{ validator: validateRealReturnMoney, trigger: 'blur' }]
			},
			authCode: "",
			selectContact: {},
			remindFlag: false, //应付积分是否大于实收上游积分
			remindMoney: 0 //实收上游积分
		};
	},
	activated: function activated() {
		this.getAllotsList();
		this.getAllotHospitalList();
		this.getBankAccount();
		this.getProductBusiness();
		this.getContacts();
		this.authCode = "," + JSON.parse(sessionStorage["user"]).authority_code;
	},
	mounted: function mounted() {},

	methods: {
		formatterNoPay: function formatterNoPay(row, column, cellValue) {
			var t = row.allot_return_money - row.allot_real_return_money;
			if (t) {
				return Math.round(t * 100) / 100;
			} else {
				return 0;
			}
		},
		formatterShouldMoney: function formatterShouldMoney(row, column, cellValue) {
			cellValue = cellValue ? cellValue : 0;
			if (row.purchase_other_money) {
				var t = row.purchase_other_money / row.purchase_number * row.allot_number;
				return cellValue - Math.round(t * 100) / 100;
			} else {
				return cellValue;
			}
		},
		formatterShouldPay: function formatterShouldPay(row, column, cellValue) {
			if (row.purchase_other_money) {
				var t = row.purchase_other_money / row.purchase_number * row.allot_number;
				row.other_monety_temp = Math.round(t * 100) / 100;
				var temp = row.allot_number * row.allot_return_price - t;
				temp = Math.round(temp * 100) / 100;
				if (row.allot_return_money != temp) {
					row.allot_return_money = temp;
					return temp;
				} else {
					return cellValue;
				}
			} else {
				return cellValue;
			}
		},
		formatterOtherMoney: function formatterOtherMoney(row, column, cellValue) {
			if (row.purchase_other_money) {
				var t = row.purchase_other_money / row.purchase_number * row.allot_number;
				row.other_monety_temp = Math.round(t * 100) / 100;
				return Math.round(t * 100) / 100;
			} else {
				return 0;
			}
		},
		formatterReturnMoney: function formatterReturnMoney(row, column, cellValue) {
			if (row.refunds_real_time && row.refunds_real_money) {
				var temp = row.refunds_real_money / row.purchase_number;
				return Math.round(temp * 100) / 100;;
			} else {
				return 0;
			}
		},
		selectAllotContact: function selectAllotContact(val) {
			this.selectContact = {};
			for (var i = 0; i < this.contacts.length; i++) {
				if (this.contacts[i].contacts_id == val) {
					this.selectContact = this.contacts[i];
				}
			}
		},
		getContacts: function getContacts() {
			var _self = this;
			this.jquery('/iae/contacts/getAllContacts', { group_id: 0, contact_type: ['调货'] }, function (res) {
				_self.contacts = res.message;
			});
		},
		getProductBusiness: function getProductBusiness() {
			var _self = this;
			this.jquery("/iae/business/getAllBusiness", null, function (res) {
				//查询商业
				_self.business = res.message;
				sessionStorage["productbusiness"] = JSON.stringify(_self.business);
			});
		},
		getBankAccount: function getBankAccount() {
			var _self = this;
			this.jquery("/iae/bankaccount/getAllAccounts", null, function (res) {
				//查询账号
				_self.accounts = res.message;
			});
		},
		getAllotHospitalList: function getAllotHospitalList() {
			var _self = this;
			this.jquery('/iae/hospitals/getAllHospitals', { hospital_type: '调货单位' }, function (res) {
				_self.hospitals = res.message;
			});
		},
		formatPercent: function formatPercent(row, column, cellValue, index) {
			if (cellValue) {
				return cellValue + " %";
			} else {
				return "-";
			}
		},
		handleSelect: function handleSelect(item) {
			this.allot.allot_hospital = item.allot_hospital;
		},
		querySearch: function querySearch(queryString, cb) {
			var hospitals = this.hospitals;
			var results = queryString ? hospitals.filter(this.createFilter(queryString)) : hospitals;
			// 调用 callback 返回建议列表的数据
			cb(results);
		},
		createFilter: function createFilter(queryString) {
			return function (hospitals) {
				if (hospitals.allot_hospital) {
					return hospitals.allot_hospital.toLowerCase().indexOf(queryString.toLowerCase()) > -1;
				} else {
					return;
				}
			};
		},
		editallots: function editallots(formName) {
			var _self = this;
			this.allot.account_detail = this.formatterDate(null, null, this.allot.allot_time) + this.allot.hospital_name + "调货（" + this.allot.allot_number + "）" + this.allot.product_common_name + "付积分";
			if (this.allot.allot_account_id && this.allot.allot_return_money) {
				this.allot.allot_account_name = this.allot.allot_account_name ? this.allot.allot_account_name : this.selectContact.account_name ? this.selectContact.account_name : "";
				this.allot.allot_account_number = this.allot.allot_account_number ? this.allot.allot_account_number : this.selectContact.account_number ? this.selectContact.account_number : "";
				this.allot.allot_account_address = this.allot.allot_account_address ? this.allot.allot_account_address : this.selectContact.account_address ? this.selectContact.account_address : "";
			}
			this.$refs[formName].validate(function (valid) {
				if (valid) {
					_self.loading = true;
					_self.jquery('/iae/allot/editAllot', _self.allot, function (res) {
						_self.dialogFormVisible = false;
						_self.loading = false;
						_self.$message({ showClose: true, message: '修改成功', type: 'success' });
						_self.getAllotsList();
					});
				} else {
					return false;
				}
			});
		},
		formatterDate: function formatterDate(row, column, cellValue) {
			if (cellValue && typeof cellValue == "string") {
				var temp = cellValue.substring(0, 10);
				var d = new Date(temp);
				d.setDate(d.getDate() + 1);
				return d.format("yyyy-MM-dd");
			} else if (cellValue && (typeof cellValue === 'undefined' ? 'undefined' : _typeof(cellValue)) == "object") {
				return new Date(cellValue).format("yyyy-MM-dd");
			} else {
				return "";
			}
		},
		editRow: function editRow(scope) {
			//编辑药品信息
			this.dialogFormVisible = true;
			var temp = JSON.stringify(scope.row);
			this.allot = JSON.parse(temp);
			this.allot.front_allot_message = temp;
			this.allot.allot_policy_money = this.allot.allot_policy_money ? this.allot.allot_policy_money : "";
			this.allot.allot_return_price = this.allot.allot_return_price ? this.allot.allot_return_price : this.allot.allot_policy_money;
			if (this.allot.allot_return_price) {
				this.allot.allot_return_money = this.allot.allot_return_money ? this.allot.allot_return_money : this.mul(this.allot.allot_return_price, this.allot.allot_number, 2);
			}
			this.allot.allot_number_temp = this.allot.allot_number;
			for (var i = 0; i < this.contacts.length; i++) {
				if (this.contacts[i].contacts_id == this.allot.allot_policy_contact_id) {
					this.selectContact = this.contacts[i];
				}
			}
			this.remindFlag = false;
			if (this.allot.refunds_real_time && this.allot.refunds_real_money) {
				this.remindFlag = this.allot.allot_return_price > this.div(this.allot.refunds_real_money, this.allot.purchase_number, 2);
				this.remindMoney = this.div(this.allot.refunds_real_money, this.allot.purchase_number, 2);
			} else {
				this.remindMoney = 0;
				this.remindFlag = true;
			}
		},
		deleteRow: function deleteRow(scope) {
			var _this2 = this;

			//删除
			this.$confirm('是否删除?', '提示', {
				confirmButtonText: '确定',
				cancelButtonText: '取消',
				type: 'warning'
			}).then(function () {
				_this2.deleteItem(scope);
			}).catch(function () {});
		},
		deleteItem: function deleteItem(scope) {
			var _self = this;
			this.jquery('/iae/allot/deleteAllot', {
				allot_id: scope.row.allot_id,
				product_type: scope.row.product_type,
				stock: scope.row.stock,
				product_id: scope.row.product_id,
				allot_number: scope.row.allot_number
			}, function (res) {
				_self.$message({ showClose: true, message: '删除成功', type: 'success' });
				_self.getAllotsList();
				_self.dialogFormVisible = false;
			});
		},
		reSearch: function reSearch(arg) {
			if (arg) {
				this.$refs["params"].resetFields();
			}
			this.currentPage = 1;
			this.getAllotsList();
		},
		exportAllotReturn: function exportAllotReturn() {
			var url = this.$bus.data.host + "/iae/allotPolicy/exportAllotRefund";
			this.download(url, this.params);
		},
		getAllotsList: function getAllotsList() {
			var _self = this;
			if (!_self.currentPage) {
				_self.currentPage = 1;
			}
			if (!_self.pageNum) {
				_self.pageNum = 10;
			}
			var page = {
				start: (_self.currentPage - 1) * _self.pageNum,
				limit: _self.pageNum
			};
			this.jquery('/iae/allotPolicy/getAllotReturnMoney', {
				data: _self.params,
				page: page
			}, function (res) {
				_self.allots = res.message.data;
				_self.pageNum = parseInt(res.message.limit);
				_self.count = res.message.totalCount;
				_self.money = (res.message.returnMoney + "").replace(/\B(?=(\d{3})+(?!\d))/g, ',');
				_self.money1 = (res.message.returnMoney1 + "").replace(/\B(?=(\d{3})+(?!\d))/g, ',');
				_self.money2 = _self.sub(res.message.returnMoney, res.message.returnMoney1, 2);
				_self.money2 = (_self.money2 + "").replace(/\B(?=(\d{3})+(?!\d))/g, ',');
			});
		},
		handleSizeChange: function handleSizeChange(val) {
			this.pageNum = val;
			this.currentPage = 1;
			this.getAllotsList();
		},
		handleCurrentChange: function handleCurrentChange(val) {
			this.currentPage = val;
			this.getAllotsList();
		}
	}
};

/***/ }),

/***/ 843:
/***/ (function(module, exports, __webpack_require__) {

module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('div', [_c('el-breadcrumb', {
    attrs: {
      "separator-class": "el-icon-arrow-right"
    }
  }, [_c('el-breadcrumb-item', [_vm._v("积分管理")]), _vm._v(" "), _c('el-breadcrumb-item', [_vm._v("调货应付管理")])], 1), _vm._v(" "), _c('el-form', {
    ref: "params",
    staticClass: "demo-form-inline search",
    attrs: {
      "inline": true,
      "model": _vm.params,
      "size": "mini"
    }
  }, [_c('el-form-item', {
    attrs: {
      "label": "调货时间",
      "prop": "allot_time"
    }
  }, [_c('el-date-picker', {
    attrs: {
      "type": "daterange",
      "size": "mini",
      "align": "right",
      "unlink-panels": "",
      "range-separator": "至",
      "start-placeholder": "开始日期",
      "end-placeholder": "结束日期",
      "picker-options": _vm.pickerOptions2
    },
    model: {
      value: (_vm.params.allot_time),
      callback: function($$v) {
        _vm.$set(_vm.params, "allot_time", $$v)
      },
      expression: "params.allot_time"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "付积分日期",
      "prop": "allotReturnTime"
    }
  }, [_c('el-date-picker', {
    staticStyle: {
      "width": "196px !important"
    },
    attrs: {
      "type": "daterange",
      "size": "mini",
      "align": "right",
      "unlink-panels": "",
      "range-separator": "至",
      "start-placeholder": "开始日期",
      "end-placeholder": "结束日期",
      "picker-options": _vm.pickerOptions2
    },
    model: {
      value: (_vm.params.allotReturnTime),
      callback: function($$v) {
        _vm.$set(_vm.params, "allotReturnTime", $$v)
      },
      expression: "params.allotReturnTime"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "产品名称",
      "prop": "productCommonName"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "size": "mini",
      "placeholder": "产品名称/助记码"
    },
    nativeOn: {
      "keyup": function($event) {
        if (!('button' in $event) && $event.keyCode !== 13) { return null; }
        _vm.reSearch(false)
      }
    },
    model: {
      value: (_vm.params.productCommonName),
      callback: function($$v) {
        _vm.$set(_vm.params, "productCommonName", $$v)
      },
      expression: "params.productCommonName"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "产品编号",
      "prop": "product_code"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "size": "mini",
      "placeholder": "产品编号"
    },
    nativeOn: {
      "keyup": function($event) {
        if (!('button' in $event) && $event.keyCode !== 13) { return null; }
        _vm.reSearch(false)
      }
    },
    model: {
      value: (_vm.params.product_code),
      callback: function($$v) {
        _vm.$set(_vm.params, "product_code", $$v)
      },
      expression: "params.product_code"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "调货单位",
      "prop": "allot_hospital"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "size": "mini",
      "filterable": "",
      "placeholder": "请选择供货单位"
    },
    model: {
      value: (_vm.params.allot_hospital),
      callback: function($$v) {
        _vm.$set(_vm.params, "allot_hospital", $$v)
      },
      expression: "params.allot_hospital"
    }
  }, [_c('el-option', {
    key: "",
    attrs: {
      "label": "全部",
      "value": ""
    }
  }), _vm._v(" "), _vm._l((_vm.hospitals), function(item) {
    return _c('el-option', {
      key: item.hospital_id,
      attrs: {
        "label": item.hospital_name,
        "value": item.hospital_id
      }
    })
  })], 2)], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "　　商业",
      "prop": "business"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "size": "mini",
      "filterable": "",
      "placeholder": "请选择商业"
    },
    model: {
      value: (_vm.params.business),
      callback: function($$v) {
        _vm.$set(_vm.params, "business", $$v)
      },
      expression: "params.business"
    }
  }, [_c('el-option', {
    key: "",
    attrs: {
      "label": "全部",
      "value": ""
    }
  }), _vm._v(" "), _vm._l((_vm.business), function(item) {
    return _c('el-option', {
      key: item.business_id,
      attrs: {
        "label": item.business_name,
        "value": item.business_id
      }
    })
  })], 2)], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "调货联系人",
      "prop": "contactId"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "196px"
    },
    attrs: {
      "filterable": "",
      "size": "mini",
      "placeholder": "请选择"
    },
    model: {
      value: (_vm.params.contactId),
      callback: function($$v) {
        _vm.$set(_vm.params, "contactId", $$v)
      },
      expression: "params.contactId"
    }
  }, [_c('el-option', {
    key: "",
    attrs: {
      "label": "全部",
      "value": ""
    }
  }), _vm._v(" "), _vm._l((_vm.contacts), function(item) {
    return _c('el-option', {
      key: item.contacts_id,
      attrs: {
        "label": item.contacts_name,
        "value": item.contacts_id
      }
    })
  })], 2)], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "积分状态",
      "prop": "allot_return_flag"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "size": "mini",
      "filterable": "",
      "placeholder": "请选择供货单位"
    },
    model: {
      value: (_vm.params.allot_return_flag),
      callback: function($$v) {
        _vm.$set(_vm.params, "allot_return_flag", $$v)
      },
      expression: "params.allot_return_flag"
    }
  }, [_c('el-option', {
    key: "",
    attrs: {
      "label": "全部",
      "value": ""
    }
  }), _vm._v(" "), _c('el-option', {
    key: "未付",
    attrs: {
      "label": "未付",
      "value": "未付"
    }
  }), _vm._v(" "), _c('el-option', {
    key: "已付",
    attrs: {
      "label": "已付",
      "value": "已付"
    }
  })], 1)], 1), _vm._v(" "), _c('el-form-item', [_c('el-button', {
    directives: [{
      name: "dbClick",
      rawName: "v-dbClick"
    }, {
      name: "show",
      rawName: "v-show",
      value: (_vm.authCode.indexOf(',126,') > -1),
      expression: "authCode.indexOf(',126,') > -1"
    }],
    staticStyle: {
      "margin-left": "14px"
    },
    attrs: {
      "type": "primary",
      "size": "mini"
    },
    on: {
      "click": function($event) {
        _vm.reSearch(false)
      }
    }
  }, [_vm._v("查询")]), _vm._v(" "), _c('el-button', {
    directives: [{
      name: "dbClick",
      rawName: "v-dbClick"
    }, {
      name: "show",
      rawName: "v-show",
      value: (_vm.authCode.indexOf(',126,') > -1),
      expression: "authCode.indexOf(',126,') > -1"
    }],
    attrs: {
      "type": "primary",
      "size": "mini"
    },
    on: {
      "click": function($event) {
        _vm.reSearch(true)
      }
    }
  }, [_vm._v("重置")]), _vm._v(" "), _c('el-button', {
    directives: [{
      name: "dbClick",
      rawName: "v-dbClick"
    }, {
      name: "show",
      rawName: "v-show",
      value: (_vm.authCode.indexOf(',137,') > -1),
      expression: "authCode.indexOf(',137,') > -1"
    }],
    attrs: {
      "type": "primary",
      "size": "mini"
    },
    on: {
      "click": _vm.exportAllotReturn
    }
  }, [_vm._v("导出")])], 1)], 1), _vm._v(" "), _c('div', {
    staticClass: "sum_money_allot"
  }, [_c('a', [_vm._v("总积分：")]), _vm._v(_vm._s(_vm.money) + "  "), _c('a', [_vm._v("已付积分：")]), _vm._v(_vm._s(_vm.money1) + " "), _c('a', [_vm._v("未付积分：")]), _vm._v(_vm._s(_vm.money2) + "\n\t\t")]), _vm._v(" "), _c('el-table', {
    staticStyle: {
      "width": "100%"
    },
    attrs: {
      "data": _vm.allots,
      "size": "mini",
      "stripe": true,
      "border": true
    }
  }, [_c('el-table-column', {
    attrs: {
      "fixed": "",
      "prop": "allot_time",
      "label": "调货时间",
      "width": "80",
      "formatter": _vm.formatterDate
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "hospital_name",
      "label": "调货单位",
      "width": "120"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "product_code",
      "label": "产品编码",
      "width": "100"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "product_common_name",
      "label": "产品通用名",
      "width": "120"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "product_specifications",
      "label": "产品规格",
      "width": "100"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "product_makesmakers",
      "label": "生产厂家",
      "width": "150"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "product_unit",
      "label": "单位",
      "width": "50"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "business_name",
      "label": "商业",
      "width": "60"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "contacts_name",
      "label": "调货联系人",
      "width": "80"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "allot_number",
      "label": "数量",
      "width": "50"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "allot_mack_price",
      "label": "打款价",
      "width": "60"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "allot_price",
      "label": "中标价",
      "width": "60"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "allot_money",
      "label": "金额",
      "width": "70"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "batch_number",
      "label": "批号"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "label": "实收上游积分(单价)",
      "width": "70",
      "formatter": _vm.formatterReturnMoney
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "allot_return_price",
      "label": "政策积分",
      "width": "70"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "label": "补点/费用票",
      "width": "80",
      "formatter": _vm.formatterOtherMoney
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "allot_return_money",
      "label": "应付积分",
      "width": "70",
      "formatter": _vm.formatterShouldPay
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "allot_real_return_money",
      "label": "实付积分",
      "width": "70"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "allot_real_return_money",
      "label": "未付积分",
      "width": "70",
      "formatter": _vm.formatterNoPay
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "allot_return_time",
      "label": "付积分时间",
      "width": "80",
      "formatter": _vm.formatterDate
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "allot_account_name",
      "label": "收积分账户名",
      "width": "80"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "allot_account_number",
      "label": "收积分账户",
      "width": "80"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "allot_account_address",
      "label": "收积分账户地址",
      "width": "80"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "allot_remark",
      "label": "备注",
      "width": "80"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "fixed": "right",
      "label": "操作",
      "width": "60"
    },
    scopedSlots: _vm._u([{
      key: "default",
      fn: function(scope) {
        return [_c('el-button', {
          directives: [{
            name: "show",
            rawName: "v-show",
            value: (_vm.authCode.indexOf(',125,') > -1),
            expression: "authCode.indexOf(',125,') > -1"
          }, {
            name: "dbClick",
            rawName: "v-dbClick"
          }],
          attrs: {
            "icon": "el-icon-edit-outline",
            "type": "primary",
            "size": "mini"
          },
          nativeOn: {
            "click": function($event) {
              $event.preventDefault();
              _vm.editRow(scope)
            }
          }
        })]
      }
    }])
  })], 1), _vm._v(" "), _c('div', {
    staticClass: "page_div"
  }, [_c('el-pagination', {
    attrs: {
      "background": "",
      "current-page": _vm.currentPage,
      "page-sizes": [5, 10, 50, 100],
      "page-size": _vm.pageNum,
      "layout": "total, sizes, prev, pager, next, jumper",
      "total": _vm.count
    },
    on: {
      "size-change": _vm.handleSizeChange,
      "current-change": _vm.handleCurrentChange
    }
  })], 1), _vm._v(" "), _c('el-dialog', {
    attrs: {
      "title": "修改调货记录",
      "width": "700px",
      "visible": _vm.dialogFormVisible
    },
    on: {
      "update:visible": function($event) {
        _vm.dialogFormVisible = $event
      }
    }
  }, [_c('el-collapse', {
    model: {
      value: (_vm.activeNames),
      callback: function($$v) {
        _vm.activeNames = $$v
      },
      expression: "activeNames"
    }
  }, [_c('el-collapse-item', {
    attrs: {
      "title": '药品信息（药品名：' + _vm.allot.product_common_name + '）',
      "name": "2"
    }
  }, [_c('div', [_c('span', [_vm._v("产品编号:")]), _vm._v(_vm._s(_vm.allot.product_code))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("产品规格:")]), _vm._v(_vm._s(_vm.allot.product_specifications))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("中标价:")]), _vm._v(_vm._s(_vm.allot.product_price))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("包装:")]), _vm._v(_vm._s(_vm.allot.product_packing))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("单位:")]), _vm._v(_vm._s(_vm.allot.product_unit))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("打款价:")]), _vm._v(_vm._s(_vm.allot.product_mack_price))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("积分:")]), _vm._v(_vm._s(_vm.allot.product_return_money))]), _vm._v(" "), _c('div', {
    staticStyle: {
      "display": "block",
      "width": "100%"
    }
  }, [_c('span', [_vm._v("生产厂家:")]), _vm._v(_vm._s(_vm.allot.product_makesmakers))])])], 1), _vm._v(" "), _c('el-form', {
    ref: "allot",
    staticClass: "demo-ruleForm",
    staticStyle: {
      "margin-top": "20px"
    },
    attrs: {
      "model": _vm.allot,
      "status-icon": "",
      "rules": _vm.allotRule,
      "inline": true,
      "label-width": "100px"
    }
  }, [_c('el-form-item', {
    attrs: {
      "label": "政策积分",
      "prop": "allot_return_price"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "179px"
    },
    attrs: {
      "placeholder": "政策积分"
    },
    model: {
      value: (_vm.allot.allot_return_price),
      callback: function($$v) {
        _vm.$set(_vm.allot, "allot_return_price", $$v)
      },
      expression: "allot.allot_return_price"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "补点/费用票",
      "prop": "other_monety_temp"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "179px"
    },
    attrs: {
      "readonly": true,
      "placeholder": "应付积分"
    },
    model: {
      value: (_vm.allot.other_monety_temp),
      callback: function($$v) {
        _vm.$set(_vm.allot, "other_monety_temp", $$v)
      },
      expression: "allot.other_monety_temp"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "应付积分",
      "prop": "allot_return_money"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "179px"
    },
    attrs: {
      "readonly": true,
      "placeholder": "应付积分"
    },
    model: {
      value: (_vm.allot.allot_return_money),
      callback: function($$v) {
        _vm.$set(_vm.allot, "allot_return_money", $$v)
      },
      expression: "allot.allot_return_money"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "实付积分",
      "prop": "allot_real_return_money"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "179px"
    },
    attrs: {
      "placeholder": "应付积分"
    },
    model: {
      value: (_vm.allot.allot_real_return_money),
      callback: function($$v) {
        _vm.$set(_vm.allot, "allot_real_return_money", $$v)
      },
      expression: "allot.allot_real_return_money"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "付积分账号",
      "prop": "allot_account_id"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "179px"
    },
    attrs: {
      "filterable": "",
      "placeholder": "请选择"
    },
    model: {
      value: (_vm.allot.allot_account_id),
      callback: function($$v) {
        _vm.$set(_vm.allot, "allot_account_id", $$v)
      },
      expression: "allot.allot_account_id"
    }
  }, _vm._l((_vm.accounts), function(item) {
    return _c('el-option', {
      key: item.account_id,
      attrs: {
        "label": item.account_number,
        "value": item.account_id
      }
    })
  }))], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "付积分时间",
      "prop": "allot_return_time"
    }
  }, [_c('el-date-picker', {
    staticStyle: {
      "width": "179px"
    },
    attrs: {
      "type": "date",
      "placeholder": "请选择付积分时间"
    },
    model: {
      value: (_vm.allot.allot_return_time),
      callback: function($$v) {
        _vm.$set(_vm.allot, "allot_return_time", $$v)
      },
      expression: "allot.allot_return_time"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "调货联系人",
      "prop": "allot_policy_contact_id"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "179px"
    },
    attrs: {
      "filterable": "",
      "placeholder": "请选择"
    },
    on: {
      "change": _vm.selectAllotContact
    },
    model: {
      value: (_vm.allot.allot_policy_contact_id),
      callback: function($$v) {
        _vm.$set(_vm.allot, "allot_policy_contact_id", $$v)
      },
      expression: "allot.allot_policy_contact_id"
    }
  }, [_c('el-option', {
    key: "",
    attrs: {
      "label": "",
      "value": ""
    }
  }), _vm._v(" "), _vm._l((_vm.contacts), function(item) {
    return _c('el-option', {
      key: item.contacts_id,
      attrs: {
        "label": item.contacts_name,
        "value": item.contacts_id
      }
    })
  })], 2)], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "备注",
      "prop": "allot_remark"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "179px"
    },
    attrs: {
      "placeholder": "备注"
    },
    model: {
      value: (_vm.allot.allot_remark),
      callback: function($$v) {
        _vm.$set(_vm.allot, "allot_remark", $$v)
      },
      expression: "allot.allot_remark"
    }
  })], 1), _vm._v(" "), _c('div', {
    directives: [{
      name: "show",
      rawName: "v-show",
      value: (_vm.selectContact.account_name && _vm.selectContact.account_number),
      expression: "selectContact.account_name && selectContact.account_number"
    }],
    staticStyle: {
      "padding-left": "16px"
    }
  }, [_c('div', [_vm._v("积分账号名：" + _vm._s(_vm.selectContact.account_name))]), _vm._v(" "), _c('div', [_vm._v("　积分账号：" + _vm._s(_vm.selectContact.account_number))]), _vm._v(" "), _c('div', [_vm._v("　积分地址：" + _vm._s(_vm.selectContact.account_address))])])], 1), _vm._v(" "), _c('div', {
    staticClass: "dialog-footer",
    attrs: {
      "slot": "footer"
    },
    slot: "footer"
  }, [_c('div', {
    directives: [{
      name: "show",
      rawName: "v-show",
      value: (_vm.remindFlag),
      expression: "remindFlag"
    }],
    staticStyle: {
      "color": "#f24040",
      "font-size": "12px",
      "padding-bottom": "5px"
    }
  }, [_vm._v("\n\t\t\t\t\t温馨提示：应付积分大于实收上游积分（" + _vm._s(_vm.remindMoney) + "）\n\t\t\t\t")]), _vm._v(" "), _c('el-button', {
    attrs: {
      "size": "small"
    },
    on: {
      "click": function($event) {
        _vm.dialogFormVisible = false
      }
    }
  }, [_vm._v("取 消")]), _vm._v(" "), _c('el-button', {
    directives: [{
      name: "dbClick",
      rawName: "v-dbClick"
    }],
    attrs: {
      "type": "primary",
      "loading": _vm.loading,
      "size": "small"
    },
    on: {
      "click": function($event) {
        _vm.editallots('allot')
      }
    }
  }, [_vm._v("确 定")])], 1)], 1)], 1)
},staticRenderFns: []}
if (false) {
  module.hot.accept()
  if (module.hot.data) {
     require("vue-hot-reload-api").rerender("data-v-6b355fcc", module.exports)
  }
}

/***/ }),

/***/ 844:
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__(845);
if(typeof content === 'string') content = [[module.i, content, '']];
// add the styles to the DOM
var update = __webpack_require__(91)(content, {});
if(content.locals) module.exports = content.locals;
// Hot Module Replacement
if(false) {
	// When the styles change, update the <style> tags
	if(!content.locals) {
		module.hot.accept("!!../../node_modules/css-loader/index.js!../../node_modules/vue-loader/lib/style-rewriter.js?id=data-v-4662f180!../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./salesReturnMoney.vue", function() {
			var newContent = require("!!../../node_modules/css-loader/index.js!../../node_modules/vue-loader/lib/style-rewriter.js?id=data-v-4662f180!../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./salesReturnMoney.vue");
			if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];
			update(newContent);
		});
	}
	// When the module is disposed, remove the <style> tags
	module.hot.dispose(function() { update(); });
}

/***/ }),

/***/ 845:
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__(2)();
// imports


// module
exports.push([module.i, "\n.sum_money{\n\tbackground-color: #fff;\n\tborder-bottom: 1px solid #ebeef5;\n\theight: 30px;\n\tline-height: 30px;\n\tpadding-left: 10px;\n\tfont-size: 14px;\n\tcolor:#606266;\n}\n.sum_money a{\n\tcolor: #f24040;\n}\n.el-collapse-item__content > div{\n\tdisplay: inline-block;\n\twidth: 30%;\n}\n.el-collapse-item__content > div > span{\n\tdisplay: inline-block;\n\twidth: 56px;\n\ttext-align: right;\n\tpadding-right: 10px;\n}\n", ""]);

// exports


/***/ }),

/***/ 846:
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
	value: true
});

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//

exports.default = {
	data: function data() {
		var nowDate = new Date();
		var beforeDate = new Date();
		beforeDate.setFullYear(nowDate.getFullYear() - 1);
		return {
			pickerOptions2: {
				shortcuts: [{
					text: '本月',
					onClick: function onClick(picker) {
						var end = new Date();
						var start = new Date(end.getFullYear() + "-" + (end.getMonth() + 1) + "-01");
						picker.$emit('pick', [start, end]);
					}
				}, {
					text: nowDate.getFullYear() + '年',
					onClick: function onClick(picker) {
						var end = new Date();
						var start = new Date(end.getFullYear() + "-01" + "-01");
						picker.$emit('pick', [start, end]);
					}
				}, {
					text: beforeDate.getFullYear() + '年',
					onClick: function onClick(picker) {
						var start = new Date(beforeDate.getFullYear() + "-01" + "-01");
						var end = new Date(beforeDate.getFullYear() + "-12" + "-31");
						picker.$emit('pick', [start, end]);
					}
				}]
			},
			sales: [],
			contacts: [],
			business: [],
			accounts: [],
			pageNum: 10,
			currentPage: 1,
			count: 0,
			hospitals: [],
			saleReturnMoney: 0, //总总额
			saleReturnMoney1: 0, //已付金额
			saleReturnMoney2: 0, //未付金额
			params: { //查询参数
				productCommonName: "",
				salesTime: [],
				salesReturnTime: [],
				hospitalsId: "",
				sale_type: "",
				business: "",
				sale_contact_id: "",
				product_code: "",
				salesReturnFlag: "flag",
				sale_return_flag: "",
				productType: ['佣金', '高打']
			},
			sale: {}, //修改的销售信息
			saleRule: {},
			dialogFormVisible: false,
			loading: false,
			authCode: "",
			selectContact: {},
			remindFlag: false, //应付积分是否大于实收上游积分
			remindMoney: 0 //实收上游积分
		};
	},
	activated: function activated() {
		this.getSalesList();
		this.getHospitals();
		this.getContacts();
		this.getProductBusiness();
		this.getBankAccount();
		this.authCode = "," + JSON.parse(sessionStorage["user"]).authority_code;
	},
	mounted: function mounted() {},

	methods: {
		selectSalesContact: function selectSalesContact(val) {
			this.selectContact = {};
			for (var i = 0; i < this.contacts.length; i++) {
				if (this.contacts[i].contacts_id == val) {
					this.selectContact = this.contacts[i];
				}
			}
		},
		saleReturnPrice: function saleReturnPrice() {
			this.sale.sale_return_money = this.mul(this.sale.sale_return_price, this.sale.sale_num, 2);
			if (this.sale.other_money_temp) {
				this.sale.sale_return_money = this.sub(this.sale.sale_return_money, this.sale.other_money_temp, 2);
			}
		},
		getBankAccount: function getBankAccount() {
			var _self = this;
			this.jquery("/iae/bankaccount/getAllAccounts", null, function (res) {
				//查询账号
				_self.accounts = res.message;
			});
		},
		getContacts: function getContacts() {
			var _self = this;
			this.jquery('/iae/contacts/getAllContacts', { group_id: 0, contact_type: ['业务员'] }, function (res) {
				_self.contacts = res.message;
			});
		},
		getProductBusiness: function getProductBusiness() {
			var _self = this;
			this.jquery("/iae/business/getAllBusiness", null, function (res) {
				//查询商业
				_self.business = res.message;
			});
		},
		formatterNoPay: function formatterNoPay(row, column, cellValue) {
			var t = row.sale_return_money - row.sale_return_real_return_money;
			if (t) {
				return Math.round(t * 100) / 100;
			} else {
				return 0;
			}
		},
		formatterShouldPay: function formatterShouldPay(row, column, cellValue) {
			if (row.product_type == '佣金' && row.sale_other_money) {
				row.other_money_temp = row.sale_other_money;
			} else if (row.product_type == '高打' && row.purchase_other_money) {
				var temp = row.purchase_other_money / row.purchase_number * row.sale_num;
				row.other_money_temp = Math.round(temp * 100) / 100;
			} else {
				row.other_money_temp = 0;
			}
			var t = row.sale_return_price * row.sale_num - row.other_money_temp;
			t = Math.round(t * 100) / 100;
			if (cellValue != t) {
				row.sale_return_money = t;
				return t;
			} else {
				return cellValue;
			}
		},
		formatterOtherMoney: function formatterOtherMoney(row, column, cellValue) {
			if (row.product_type == '佣金' && row.sale_other_money) {
				row.other_money_temp = row.sale_other_money;
				return row.sale_other_money;
			} else if (row.product_type == '高打' && row.purchase_other_money) {
				var temp = row.purchase_other_money / row.purchase_number * row.sale_num;
				row.other_money_temp = Math.round(temp * 100) / 100;
				return Math.round(temp * 100) / 100;
			} else {
				return 0;
			}
		},
		formatterShouldMoney: function formatterShouldMoney(row, column, cellValue) {
			if (row.product_type == '佣金' && row.sale_other_money) {
				return row.sale_return_money - row.sale_other_money;
			} else if (row.product_type == '高打' && row.purchase_other_money) {
				var temp = row.purchase_other_money / row.purchase_number * row.sale_num;
				return row.sale_return_money - Math.round(temp * 100) / 100;
			} else {
				return cellValue;
			}
		},
		formatterReturnMoney: function formatterReturnMoney(row, column, cellValue) {
			if (row.product_type == '佣金' && row.refunds_real_time && row.refunds_real_money) {
				return this.div(row.refunds_real_money + "", row.sale_num + "", 2);
			} else if (row.product_type == '高打' && row.refunds_real_time && row.refunds_real_money) {
				return this.div(row.refunds_real_money + "", row.purchase_number + "", 2);
			} else {
				return 0;
			}
		},
		formatterType: function formatterType(row, column, cellValue) {
			return cellValue == '1' ? "销售出库" : cellValue == '2' ? "销售退回" : "销售退补价";
		},
		formatterDate: function formatterDate(row, column, cellValue) {
			if (cellValue && typeof cellValue == "string") {
				var temp = cellValue.substring(0, 10);
				var d = new Date(temp);
				d.setDate(d.getDate() + 1);
				return d.format("yyyy-MM-dd");
			} else if (cellValue && (typeof cellValue === "undefined" ? "undefined" : _typeof(cellValue)) == "object") {
				return new Date(cellValue).format("yyyy-MM-dd");
			} else {
				return "";
			}
		},
		editRow: function editRow(scope) {
			//编辑药品信息
			this.dialogFormVisible = true;
			var temp = JSON.stringify(scope.row);
			this.sale = JSON.parse(temp);
			this.sale.front_sale_pay = temp;
			this.sale.sale_contact_id = this.sale.sale_contact_id ? this.sale.sale_contact_id : this.sale.sale_policy_contact_id;
			this.sale.sale_return_price = this.sale.sale_return_price ? this.sale.sale_return_price : this.sale.sale_policy_money;
			this.sale.sale_return_money = this.sale.sale_return_money ? this.sale.sale_return_money : this.mul(this.sale.sale_return_price, this.sale.sale_num, 2);
			this.sale.sale_num_temp = this.sale.sale_num;
			for (var i = 0; i < this.contacts.length; i++) {
				if (this.contacts[i].contacts_id == this.sale.sale_contact_id) {
					this.selectContact = this.contacts[i];
				}
			}
			this.remindFlag = false;
			if (this.sale.product_type == '佣金' && this.sale.refunds_real_time && this.sale.refunds_real_money) {
				this.remindFlag = this.sale.sale_return_price > this.div(this.sale.refunds_real_money, this.sale.sale_num, 2);
				this.remindMoney = this.div(this.sale.refunds_real_money, this.sale.sale_num, 2);
			} else if (this.sale.product_type == '高打' && this.sale.refunds_real_time && this.sale.refunds_real_money) {
				this.remindFlag = this.sale.sale_return_price > this.div(this.sale.refunds_real_money, this.sale.purchase_number, 2);
				this.remindMoney = this.div(this.sale.refunds_real_money, this.sale.sale_num, 2);
			} else {
				this.remindMoney = 0;
				this.remindFlag = true;
			}
		},
		reSearch: function reSearch(arg) {
			if (arg) {
				this.$refs["params"].resetFields();
			}
			this.currentPage = 1;
			this.getSalesList();
		},
		getHospitals: function getHospitals() {
			var _self = this;
			this.jquery('/iae/hospitals/getAllHospitals', { hospital_type: '销售单位' }, function (res) {
				_self.hospitals = res.message;
			});
		},
		exportSaleReturn: function exportSaleReturn() {
			var url = this.$bus.data.host + "/iae/salesPolicy/exportSalesRefund";
			this.download(url, this.params);
		},
		getSalesList: function getSalesList() {
			var _self = this;
			if (!_self.currentPage) {
				_self.currentPage = 1;
			}
			if (!_self.pageNum) {
				_self.pageNum = 10;
			}
			var page = {
				start: (_self.currentPage - 1) * _self.pageNum,
				limit: _self.pageNum
			};
			this.jquery('/iae/salesPolicy/getSalesReturnMoney', {
				data: _self.params,
				page: page
			}, function (res) {
				_self.saleReturnMoney = (res.message.saleReturnMoney + "").replace(/\B(?=(\d{3})+(?!\d))/g, ',');
				_self.saleReturnMoney1 = (res.message.saleReturnMoney1 + "").replace(/\B(?=(\d{3})+(?!\d))/g, ',');
				_self.saleReturnMoney2 = _self.sub(res.message.saleReturnMoney + "", res.message.saleReturnMoney1 + "", 2);
				_self.saleReturnMoney2 = (_self.saleReturnMoney2 + "").replace(/\B(?=(\d{3})+(?!\d))/g, ',');
				_self.sales = res.message.data;
				_self.pageNum = parseInt(res.message.limit);
				_self.count = res.message.totalCount;
			});
		},
		editSales: function editSales(formName) {
			var _this = this;

			var _self = this;
			this.sale.gross_profit = 0;
			this.sale.real_gross_profit = 0;
			if (this.sale.cost_univalent) {
				this.sale.gross_profit = this.mul(this.sale.sale_num, this.sub(this.sale.sale_price, this.sale.cost_univalent), 2);
			}
			if (this.sale.accounting_cost) {
				this.sale.real_gross_profit = this.mul(this.sale.sale_num, this.sub(this.sale.sale_price, this.sale.accounting_cost), 2);
			}
			if (this.sale.sale_account_id && this.sale.sale_return_money) {
				this.sale.sale_account_name = this.sale.sale_account_name ? this.sale.sale_account_name : this.selectContact.account_name ? this.selectContact.account_name : "";
				this.sale.sale_account_number = this.sale.sale_account_number ? this.sale.sale_account_number : this.selectContact.account_number ? this.selectContact.account_number : "";
				this.sale.sale_account_address = this.sale.sale_account_address ? this.sale.sale_account_address : this.selectContact.account_address ? this.selectContact.account_address : "";
			}
			this.$refs[formName].validate(function (valid) {
				if (valid) {
					_this.loading = true;
					_self.jquery('/iae/salesPolicy/editSalesPay', _self.sale, function (res) {
						_self.dialogFormVisible = false;
						_self.loading = false;
						_self.$message({ showClose: true, message: '修改成功', type: 'success' });
						_self.getSalesList();
					});
				} else {
					return false;
				}
			});
		},
		handleSizeChange: function handleSizeChange(val) {
			this.pageNum = val;
			this.currentPage = 1;
			this.getSalesList();
		},
		handleCurrentChange: function handleCurrentChange(val) {
			this.currentPage = val;
			this.getSalesList();
		}
	}
};

/***/ }),

/***/ 847:
/***/ (function(module, exports, __webpack_require__) {

module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('div', {
    staticStyle: {
      "box-sizing": "border-box",
      "padding": "0px 10px"
    }
  }, [_c('el-breadcrumb', {
    attrs: {
      "separator-class": "el-icon-arrow-right"
    }
  }, [_c('el-breadcrumb-item', [_vm._v("积分管理")]), _vm._v(" "), _c('el-breadcrumb-item', [_vm._v("销售应付管理")])], 1), _vm._v(" "), _c('el-form', {
    ref: "params",
    staticClass: "demo-form-inline search",
    attrs: {
      "inline": true,
      "model": _vm.params,
      "size": "mini"
    }
  }, [_c('el-form-item', {
    attrs: {
      "label": "销售日期",
      "prop": "salesTime"
    }
  }, [_c('el-date-picker', {
    attrs: {
      "type": "daterange",
      "size": "mini",
      "align": "right",
      "unlink-panels": "",
      "range-separator": "至",
      "start-placeholder": "开始日期",
      "end-placeholder": "结束日期",
      "picker-options": _vm.pickerOptions2
    },
    model: {
      value: (_vm.params.salesTime),
      callback: function($$v) {
        _vm.$set(_vm.params, "salesTime", $$v)
      },
      expression: "params.salesTime"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "付积分日期",
      "prop": "salesReturnTime"
    }
  }, [_c('el-date-picker', {
    staticStyle: {
      "width": "196px !important"
    },
    attrs: {
      "type": "daterange",
      "size": "mini",
      "align": "right",
      "unlink-panels": "",
      "range-separator": "至",
      "start-placeholder": "开始日期",
      "end-placeholder": "结束日期",
      "picker-options": _vm.pickerOptions2
    },
    model: {
      value: (_vm.params.salesReturnTime),
      callback: function($$v) {
        _vm.$set(_vm.params, "salesReturnTime", $$v)
      },
      expression: "params.salesReturnTime"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "产品名称",
      "prop": "productCommonName"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "size": "mini",
      "placeholder": "产品名称/助记码"
    },
    nativeOn: {
      "keyup": function($event) {
        if (!('button' in $event) && $event.keyCode !== 13) { return null; }
        _vm.reSearch(false)
      }
    },
    model: {
      value: (_vm.params.productCommonName),
      callback: function($$v) {
        _vm.$set(_vm.params, "productCommonName", $$v)
      },
      expression: "params.productCommonName"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "产品编号",
      "prop": "product_code"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "size": "mini",
      "placeholder": "产品编号"
    },
    nativeOn: {
      "keyup": function($event) {
        if (!('button' in $event) && $event.keyCode !== 13) { return null; }
        _vm.reSearch(false)
      }
    },
    model: {
      value: (_vm.params.product_code),
      callback: function($$v) {
        _vm.$set(_vm.params, "product_code", $$v)
      },
      expression: "params.product_code"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "　业务员",
      "prop": "sale_contact_id"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "filterable": "",
      "size": "mini",
      "placeholder": "请选择"
    },
    model: {
      value: (_vm.params.sale_contact_id),
      callback: function($$v) {
        _vm.$set(_vm.params, "sale_contact_id", $$v)
      },
      expression: "params.sale_contact_id"
    }
  }, [_c('el-option', {
    key: "",
    attrs: {
      "label": "全部",
      "value": ""
    }
  }), _vm._v(" "), _vm._l((_vm.contacts), function(item) {
    return _c('el-option', {
      key: item.contacts_id,
      attrs: {
        "label": item.contacts_name,
        "value": item.contacts_id
      }
    })
  })], 2)], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "销往单位",
      "prop": "hospitalsId"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "filterable": "",
      "size": "mini",
      "placeholder": "请选择"
    },
    model: {
      value: (_vm.params.hospitalsId),
      callback: function($$v) {
        _vm.$set(_vm.params, "hospitalsId", $$v)
      },
      expression: "params.hospitalsId"
    }
  }, [_c('el-option', {
    key: "",
    attrs: {
      "label": "全部",
      "value": ""
    }
  }), _vm._v(" "), _vm._l((_vm.hospitals), function(item) {
    return _c('el-option', {
      key: item.hospital_id,
      attrs: {
        "label": item.hospital_name,
        "value": item.hospital_id
      }
    })
  })], 2)], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "　　商业",
      "prop": "business"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "size": "mini",
      "filterable": "",
      "placeholder": "请选择商业"
    },
    model: {
      value: (_vm.params.business),
      callback: function($$v) {
        _vm.$set(_vm.params, "business", $$v)
      },
      expression: "params.business"
    }
  }, [_c('el-option', {
    key: "",
    attrs: {
      "label": "全部",
      "value": ""
    }
  }), _vm._v(" "), _vm._l((_vm.business), function(item) {
    return _c('el-option', {
      key: item.business_id,
      attrs: {
        "label": item.business_name,
        "value": item.business_id
      }
    })
  })], 2)], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "销售类型",
      "prop": "sale_type"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "size": "mini",
      "placeholder": "请选择"
    },
    model: {
      value: (_vm.params.sale_type),
      callback: function($$v) {
        _vm.$set(_vm.params, "sale_type", $$v)
      },
      expression: "params.sale_type"
    }
  }, [_c('el-option', {
    key: "",
    attrs: {
      "label": "全部",
      "value": ""
    }
  }), _vm._v(" "), _c('el-option', {
    key: "1",
    attrs: {
      "label": "销售出库",
      "value": "1"
    }
  }), _vm._v(" "), _c('el-option', {
    key: "2",
    attrs: {
      "label": "销售退回",
      "value": "2"
    }
  }), _vm._v(" "), _c('el-option', {
    key: "3",
    attrs: {
      "label": "销售退补价",
      "value": "3"
    }
  })], 1)], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "积分状态",
      "prop": "sale_return_flag"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "210px"
    },
    attrs: {
      "size": "mini",
      "filterable": "",
      "placeholder": "请选择供货单位"
    },
    model: {
      value: (_vm.params.sale_return_flag),
      callback: function($$v) {
        _vm.$set(_vm.params, "sale_return_flag", $$v)
      },
      expression: "params.sale_return_flag"
    }
  }, [_c('el-option', {
    key: "",
    attrs: {
      "label": "全部",
      "value": ""
    }
  }), _vm._v(" "), _c('el-option', {
    key: "未付",
    attrs: {
      "label": "未付",
      "value": "未付"
    }
  }), _vm._v(" "), _c('el-option', {
    key: "已付",
    attrs: {
      "label": "已付",
      "value": "已付"
    }
  })], 1)], 1), _vm._v(" "), _c('el-form-item', [_c('el-button', {
    directives: [{
      name: "dbClick",
      rawName: "v-dbClick"
    }, {
      name: "show",
      rawName: "v-show",
      value: (_vm.authCode.indexOf(',127,') > -1),
      expression: "authCode.indexOf(',127,') > -1"
    }],
    staticStyle: {
      "margin-left": "14px"
    },
    attrs: {
      "type": "primary",
      "size": "mini"
    },
    on: {
      "click": function($event) {
        _vm.reSearch(false)
      }
    }
  }, [_vm._v("查询")]), _vm._v(" "), _c('el-button', {
    directives: [{
      name: "dbClick",
      rawName: "v-dbClick"
    }, {
      name: "show",
      rawName: "v-show",
      value: (_vm.authCode.indexOf(',127,') > -1),
      expression: "authCode.indexOf(',127,') > -1"
    }],
    attrs: {
      "type": "primary",
      "size": "mini"
    },
    on: {
      "click": function($event) {
        _vm.reSearch(true)
      }
    }
  }, [_vm._v("重置")]), _vm._v(" "), _c('el-button', {
    directives: [{
      name: "dbClick",
      rawName: "v-dbClick"
    }, {
      name: "show",
      rawName: "v-show",
      value: (_vm.authCode.indexOf(',136,') > -1),
      expression: "authCode.indexOf(',136,') > -1"
    }],
    attrs: {
      "type": "primary",
      "size": "mini"
    },
    on: {
      "click": _vm.exportSaleReturn
    }
  }, [_vm._v("导出")])], 1)], 1), _vm._v(" "), _c('div', {
    staticClass: "sum_money"
  }, [_vm._v("应付积分："), _c('a', [_vm._v(_vm._s(_vm.saleReturnMoney))]), _vm._v(" 已付积分："), _c('a', [_vm._v(_vm._s(_vm.saleReturnMoney1))]), _vm._v(" 未付积分："), _c('a', [_vm._v(_vm._s(_vm.saleReturnMoney2))])]), _vm._v(" "), _c('el-table', {
    staticStyle: {
      "width": "100%"
    },
    attrs: {
      "data": _vm.sales,
      "size": "mini",
      "stripe": true,
      "border": true
    }
  }, [_c('el-table-column', {
    attrs: {
      "fixed": "",
      "prop": "bill_date",
      "label": "日期",
      "width": "80",
      "formatter": _vm.formatterDate
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "hospital_name",
      "label": "销往单位",
      "width": "140"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "product_code",
      "label": "产品编码",
      "width": "100"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "product_common_name",
      "label": "产品名称",
      "width": "120"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "product_specifications",
      "label": "产品规格",
      "width": "100"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "product_makesmakers",
      "label": "生产厂家",
      "width": "150"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "business_name",
      "label": "商业",
      "width": "60"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "sale_type",
      "label": "销售类型",
      "width": "60",
      "formatter": _vm.formatterType
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "product_type",
      "label": "品种类型",
      "width": "60"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "sale_price",
      "label": "中标价",
      "width": "60"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "sale_num",
      "label": "销售数量",
      "width": "70"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "sale_money",
      "label": "购入金额",
      "width": "70"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "batch_number",
      "label": "批号",
      "width": "70"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "label": "实收上游积分(单价)",
      "width": "70",
      "formatter": _vm.formatterReturnMoney
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "sale_return_price",
      "label": "政策积分",
      "width": "70"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "sale_return_money",
      "label": "补点/费用票",
      "width": "80",
      "formatter": _vm.formatterOtherMoney
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "sale_return_money",
      "label": "应付积分",
      "width": "70",
      "formatter": _vm.formatterShouldPay
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "sale_return_real_return_money",
      "label": "实付积分",
      "width": "70"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "sale_return_real_return_money",
      "label": "未付积分",
      "width": "70",
      "formatter": _vm.formatterNoPay
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "sale_return_time",
      "label": "付积分时间",
      "width": "70",
      "formatter": _vm.formatterDate
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "sale_account_name",
      "label": "收积分账户名",
      "width": "80"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "sale_account_number",
      "label": "收积分账户",
      "width": "80"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "sale_account_address",
      "label": "收积分账户地址",
      "width": "80"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "prop": "sale_remark",
      "label": "备注",
      "width": "70"
    }
  }), _vm._v(" "), _c('el-table-column', {
    attrs: {
      "fixed": "right",
      "label": "操作",
      "width": "60"
    },
    scopedSlots: _vm._u([{
      key: "default",
      fn: function(scope) {
        return [_c('el-button', {
          directives: [{
            name: "dbClick",
            rawName: "v-dbClick"
          }, {
            name: "show",
            rawName: "v-show",
            value: (_vm.authCode.indexOf(',128,') > -1),
            expression: "authCode.indexOf(',128,') > -1"
          }],
          attrs: {
            "icon": "el-icon-edit-outline",
            "type": "primary",
            "size": "mini"
          },
          nativeOn: {
            "click": function($event) {
              $event.preventDefault();
              _vm.editRow(scope)
            }
          }
        })]
      }
    }])
  })], 1), _vm._v(" "), _c('div', {
    staticClass: "page_div"
  }, [_c('el-pagination', {
    attrs: {
      "background": "",
      "current-page": _vm.currentPage,
      "page-sizes": [5, 10, 50, 100],
      "page-size": _vm.pageNum,
      "layout": "total, sizes, prev, pager, next",
      "total": _vm.count
    },
    on: {
      "size-change": _vm.handleSizeChange,
      "current-change": _vm.handleCurrentChange
    }
  })], 1), _vm._v(" "), _c('el-dialog', {
    attrs: {
      "title": "修改销售积分记录",
      "width": "700px",
      "visible": _vm.dialogFormVisible
    },
    on: {
      "update:visible": function($event) {
        _vm.dialogFormVisible = $event
      }
    }
  }, [_c('el-collapse', {
    model: {
      value: (_vm.activeNames),
      callback: function($$v) {
        _vm.activeNames = $$v
      },
      expression: "activeNames"
    }
  }, [_c('el-collapse-item', {
    attrs: {
      "title": '药品信息（药品名：' + _vm.sale.product_common_name + '）',
      "name": "1"
    }
  }, [_c('div', [_c('span', [_vm._v("产品编号:")]), _vm._v(_vm._s(_vm.sale.product_code))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("产品规格:")]), _vm._v(_vm._s(_vm.sale.product_specifications))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("中标价:")]), _vm._v(_vm._s(_vm.sale.sale_price))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("包装:")]), _vm._v(_vm._s(_vm.sale.product_packing))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("单位:")]), _vm._v(_vm._s(_vm.sale.product_unit))]), _vm._v(" "), _c('div', [_c('span', [_vm._v("积分:")]), _vm._v(_vm._s(_vm.sale.product_return_money))]), _vm._v(" "), _c('div', {
    staticStyle: {
      "display": "block",
      "width": "100%"
    }
  }, [_c('span', [_vm._v("生产厂家:")]), _vm._v(_vm._s(_vm.sale.product_makesmakers))])])], 1), _vm._v(" "), _c('el-form', {
    ref: "sale",
    staticClass: "demo-ruleForm",
    staticStyle: {
      "margin-top": "20px"
    },
    attrs: {
      "model": _vm.sale,
      "status-icon": "",
      "rules": _vm.saleRule,
      "inline": true,
      "label-width": "100px"
    }
  }, [_c('el-form-item', {
    attrs: {
      "label": "政策积分",
      "prop": "sale_return_price"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "179px"
    },
    attrs: {
      "placeholder": "政策积分"
    },
    on: {
      "blur": _vm.saleReturnPrice
    },
    model: {
      value: (_vm.sale.sale_return_price),
      callback: function($$v) {
        _vm.$set(_vm.sale, "sale_return_price", $$v)
      },
      expression: "sale.sale_return_price"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "补点/费用票",
      "prop": "other_money_temp"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "179px"
    },
    attrs: {
      "placeholder": "补点/费用票",
      "readonly": true
    },
    model: {
      value: (_vm.sale.other_money_temp),
      callback: function($$v) {
        _vm.$set(_vm.sale, "other_money_temp", $$v)
      },
      expression: "sale.other_money_temp"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "应付积分",
      "prop": "sale_return_money"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "179px"
    },
    attrs: {
      "placeholder": "应付积分",
      "readonly": true
    },
    model: {
      value: (_vm.sale.sale_return_money),
      callback: function($$v) {
        _vm.$set(_vm.sale, "sale_return_money", $$v)
      },
      expression: "sale.sale_return_money"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "实付积分",
      "prop": "sale_return_real_return_money"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "179px"
    },
    attrs: {
      "placeholder": "实付积分"
    },
    model: {
      value: (_vm.sale.sale_return_real_return_money),
      callback: function($$v) {
        _vm.$set(_vm.sale, "sale_return_real_return_money", $$v)
      },
      expression: "sale.sale_return_real_return_money"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "付积分账号",
      "prop": "sale_account_id"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "179px"
    },
    attrs: {
      "filterable": "",
      "placeholder": "请选择"
    },
    model: {
      value: (_vm.sale.sale_account_id),
      callback: function($$v) {
        _vm.$set(_vm.sale, "sale_account_id", $$v)
      },
      expression: "sale.sale_account_id"
    }
  }, _vm._l((_vm.accounts), function(item) {
    return _c('el-option', {
      key: item.account_id,
      attrs: {
        "label": item.account_number,
        "value": item.account_id
      }
    })
  }))], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "付积分时间",
      "prop": "sale_return_time"
    }
  }, [_c('el-date-picker', {
    staticStyle: {
      "width": "179px"
    },
    attrs: {
      "type": "date",
      "placeholder": "请选择付积分时间"
    },
    model: {
      value: (_vm.sale.sale_return_time),
      callback: function($$v) {
        _vm.$set(_vm.sale, "sale_return_time", $$v)
      },
      expression: "sale.sale_return_time"
    }
  })], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "业务员",
      "prop": "sale_contact_id"
    }
  }, [_c('el-select', {
    staticStyle: {
      "width": "179px"
    },
    attrs: {
      "filterable": "",
      "placeholder": "请选择"
    },
    on: {
      "change": _vm.selectSalesContact
    },
    model: {
      value: (_vm.sale.sale_contact_id),
      callback: function($$v) {
        _vm.$set(_vm.sale, "sale_contact_id", $$v)
      },
      expression: "sale.sale_contact_id"
    }
  }, [_c('el-option', {
    key: "",
    attrs: {
      "label": "",
      "value": ""
    }
  }), _vm._v(" "), _vm._l((_vm.contacts), function(item) {
    return _c('el-option', {
      key: item.contacts_id,
      attrs: {
        "label": item.contacts_name,
        "value": item.contacts_id
      }
    })
  })], 2)], 1), _vm._v(" "), _c('el-form-item', {
    attrs: {
      "label": "备注",
      "prop": "sale_remark"
    }
  }, [_c('el-input', {
    staticStyle: {
      "width": "179px"
    },
    attrs: {
      "placeholder": "备注"
    },
    model: {
      value: (_vm.sale.sale_remark),
      callback: function($$v) {
        _vm.$set(_vm.sale, "sale_remark", $$v)
      },
      expression: "sale.sale_remark"
    }
  })], 1), _vm._v(" "), _c('div', {
    directives: [{
      name: "show",
      rawName: "v-show",
      value: (_vm.selectContact.account_name && _vm.selectContact.account_number),
      expression: "selectContact.account_name && selectContact.account_number"
    }],
    staticStyle: {
      "padding-left": "16px"
    }
  }, [_c('div', [_vm._v("积分账号名：" + _vm._s(_vm.selectContact.account_name))]), _vm._v(" "), _c('div', [_vm._v("　积分账号：" + _vm._s(_vm.selectContact.account_number))]), _vm._v(" "), _c('div', [_vm._v("　积分地址：" + _vm._s(_vm.selectContact.account_address))])])], 1), _vm._v(" "), _c('div', {
    staticClass: "dialog-footer",
    attrs: {
      "slot": "footer"
    },
    slot: "footer"
  }, [_c('div', {
    directives: [{
      name: "show",
      rawName: "v-show",
      value: (_vm.remindFlag),
      expression: "remindFlag"
    }],
    staticStyle: {
      "color": "#f24040",
      "font-size": "12px",
      "padding-bottom": "5px"
    }
  }, [_vm._v("\n\t\t\t\t\t温馨提示：应付积分大于实收上游积分（" + _vm._s(_vm.remindMoney) + "）\n\t\t\t\t")]), _vm._v(" "), _c('el-button', {
    directives: [{
      name: "dbClick",
      rawName: "v-dbClick"
    }],
    attrs: {
      "size": "small"
    },
    on: {
      "click": function($event) {
        _vm.dialogFormVisible = false
      }
    }
  }, [_vm._v("取 消")]), _vm._v(" "), _c('el-button', {
    directives: [{
      name: "dbClick",
      rawName: "v-dbClick"
    }],
    attrs: {
      "type": "primary",
      "size": "small",
      "loading": _vm.loading
    },
    on: {
      "click": function($event) {
        _vm.editSales('sale')
      }
    }
  }, [_vm._v("确 定")])], 1)], 1)], 1)
},staticRenderFns: []}
if (false) {
  module.hot.accept()
  if (module.hot.data) {
     require("vue-hot-reload-api").rerender("data-v-4662f180", module.exports)
  }
}

/***/ }),

/***/ 91:
/***/ (function(module, exports) {

/*
	MIT License http://www.opensource.org/licenses/mit-license.php
	Author Tobias Koppers @sokra
*/
var stylesInDom = {},
	memoize = function(fn) {
		var memo;
		return function () {
			if (typeof memo === "undefined") memo = fn.apply(this, arguments);
			return memo;
		};
	},
	isOldIE = memoize(function() {
		return /msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase());
	}),
	getHeadElement = memoize(function () {
		return document.head || document.getElementsByTagName("head")[0];
	}),
	singletonElement = null,
	singletonCounter = 0,
	styleElementsInsertedAtTop = [];

module.exports = function(list, options) {
	if(typeof DEBUG !== "undefined" && DEBUG) {
		if(typeof document !== "object") throw new Error("The style-loader cannot be used in a non-browser environment");
	}

	options = options || {};
	// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>
	// tags it will allow on a page
	if (typeof options.singleton === "undefined") options.singleton = isOldIE();

	// By default, add <style> tags to the bottom of <head>.
	if (typeof options.insertAt === "undefined") options.insertAt = "bottom";

	var styles = listToStyles(list);
	addStylesToDom(styles, options);

	return function update(newList) {
		var mayRemove = [];
		for(var i = 0; i < styles.length; i++) {
			var item = styles[i];
			var domStyle = stylesInDom[item.id];
			domStyle.refs--;
			mayRemove.push(domStyle);
		}
		if(newList) {
			var newStyles = listToStyles(newList);
			addStylesToDom(newStyles, options);
		}
		for(var i = 0; i < mayRemove.length; i++) {
			var domStyle = mayRemove[i];
			if(domStyle.refs === 0) {
				for(var j = 0; j < domStyle.parts.length; j++)
					domStyle.parts[j]();
				delete stylesInDom[domStyle.id];
			}
		}
	};
}

function addStylesToDom(styles, options) {
	for(var i = 0; i < styles.length; i++) {
		var item = styles[i];
		var domStyle = stylesInDom[item.id];
		if(domStyle) {
			domStyle.refs++;
			for(var j = 0; j < domStyle.parts.length; j++) {
				domStyle.parts[j](item.parts[j]);
			}
			for(; j < item.parts.length; j++) {
				domStyle.parts.push(addStyle(item.parts[j], options));
			}
		} else {
			var parts = [];
			for(var j = 0; j < item.parts.length; j++) {
				parts.push(addStyle(item.parts[j], options));
			}
			stylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};
		}
	}
}

function listToStyles(list) {
	var styles = [];
	var newStyles = {};
	for(var i = 0; i < list.length; i++) {
		var item = list[i];
		var id = item[0];
		var css = item[1];
		var media = item[2];
		var sourceMap = item[3];
		var part = {css: css, media: media, sourceMap: sourceMap};
		if(!newStyles[id])
			styles.push(newStyles[id] = {id: id, parts: [part]});
		else
			newStyles[id].parts.push(part);
	}
	return styles;
}

function insertStyleElement(options, styleElement) {
	var head = getHeadElement();
	var lastStyleElementInsertedAtTop = styleElementsInsertedAtTop[styleElementsInsertedAtTop.length - 1];
	if (options.insertAt === "top") {
		if(!lastStyleElementInsertedAtTop) {
			head.insertBefore(styleElement, head.firstChild);
		} else if(lastStyleElementInsertedAtTop.nextSibling) {
			head.insertBefore(styleElement, lastStyleElementInsertedAtTop.nextSibling);
		} else {
			head.appendChild(styleElement);
		}
		styleElementsInsertedAtTop.push(styleElement);
	} else if (options.insertAt === "bottom") {
		head.appendChild(styleElement);
	} else {
		throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");
	}
}

function removeStyleElement(styleElement) {
	styleElement.parentNode.removeChild(styleElement);
	var idx = styleElementsInsertedAtTop.indexOf(styleElement);
	if(idx >= 0) {
		styleElementsInsertedAtTop.splice(idx, 1);
	}
}

function createStyleElement(options) {
	var styleElement = document.createElement("style");
	styleElement.type = "text/css";
	insertStyleElement(options, styleElement);
	return styleElement;
}

function addStyle(obj, options) {
	var styleElement, update, remove;

	if (options.singleton) {
		var styleIndex = singletonCounter++;
		styleElement = singletonElement || (singletonElement = createStyleElement(options));
		update = applyToSingletonTag.bind(null, styleElement, styleIndex, false);
		remove = applyToSingletonTag.bind(null, styleElement, styleIndex, true);
	} else {
		styleElement = createStyleElement(options);
		update = applyToTag.bind(null, styleElement);
		remove = function() {
			removeStyleElement(styleElement);
		};
	}

	update(obj);

	return function updateStyle(newObj) {
		if(newObj) {
			if(newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap)
				return;
			update(obj = newObj);
		} else {
			remove();
		}
	};
}

var replaceText = (function () {
	var textStore = [];

	return function (index, replacement) {
		textStore[index] = replacement;
		return textStore.filter(Boolean).join('\n');
	};
})();

function applyToSingletonTag(styleElement, index, remove, obj) {
	var css = remove ? "" : obj.css;

	if (styleElement.styleSheet) {
		styleElement.styleSheet.cssText = replaceText(index, css);
	} else {
		var cssNode = document.createTextNode(css);
		var childNodes = styleElement.childNodes;
		if (childNodes[index]) styleElement.removeChild(childNodes[index]);
		if (childNodes.length) {
			styleElement.insertBefore(cssNode, childNodes[index]);
		} else {
			styleElement.appendChild(cssNode);
		}
	}
}

function applyToTag(styleElement, obj) {
	var css = obj.css;
	var media = obj.media;
	var sourceMap = obj.sourceMap;

	if (media) {
		styleElement.setAttribute("media", media);
	}

	if (sourceMap) {
		// https://developer.chrome.com/devtools/docs/javascript-debugging
		// this makes source maps inside style tags work properly in Chrome
		css += '\n/*# sourceURL=' + sourceMap.sources[0] + ' */';
		// http://stackoverflow.com/a/26603875
		css += "\n/*# sourceMappingURL=data:application/json;base64," + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + " */";
	}

	if (styleElement.styleSheet) {
		styleElement.styleSheet.cssText = css;
	} else {
		while(styleElement.firstChild) {
			styleElement.removeChild(styleElement.firstChild);
		}
		styleElement.appendChild(document.createTextNode(css));
	}
}


/***/ })

});